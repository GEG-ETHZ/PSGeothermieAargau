
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "WP2-geo_modeling\Model_PCT_GemPy.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_WP2-geo_modeling_Model_PCT_GemPy.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_WP2-geo_modeling_Model_PCT_GemPy.py:


Create a 3D model of a Permo-Carboniferous Trough (PCT)
=======================================================

Based on four seismic sections from the NAGRA report 
`NAGRA NTB 14-02 <https://www.nagra.ch/data/documents/database/dokumente/$default/Default\%20Folder/Publikationen/NTBs\%202014\%20-\%202015/d_ntb14-02\%20Dossier\%20I.pdf>`_ [1], 
we extracted interface and orientation points of main eras (paleozoic, mesozoic, cenozoic) and major graben faults. 
Data from these 2D sections are complemented with data from GeoMol 2019, e.g. base of the PCT, thrusts, and normal faults. 

The lithological units comprise the permo-carboniferous filling (paleozoic), Mesozoic, Tertiary strata, as well as the crystalline basement rocks. An important decision before building the geological model,
is to define model units. Based on the purpose of the envisaged model, different units have to be defined. As the final result of this work will be an ensemble of advective heat-transport models,
key paremeters for defining units are permeability, porosity, thermal conductivity of different geological layers. As part of the exploration work of nagra 
(National Cooperative for the Disposal of Radioactive Waste), regional and local hydrogeological models were constructed. The therein defined hydrostratigraphy provides the basis for defining the 
model units of this geological model. The regional hydrogeologic model is presented in the report 
`NAGRA NAB 13-23 <https://www.nagra.ch/data/documents/database/dokumente/$default/Default\%20Folder/Publikationen/NABs\%202004\%20-\%202015/e_nab13-023.pdf>`_ [2]. 

With the regional model covering an area comprising all potential storage sites defined by nagra, local models were built as well. These models comprise a more detailed hydrostratigraphy. 

The potential storage site "Jura Ost" is within our model area, thus we also consider the hydrostratigraphy defined in this local hydrogeological model presented in the report 
`NAGRA NAB 13-26 <https://www.nagra.ch/data/documents/database/dokumente/$default/Default\%20Folder/Publikationen/NABs\%202004%20-\%202015/e_nab13-026.pdf>`_ [3].

The model comprises an area of 45 km x 32 km, in x- and y-direction, respectively. It extends down to a depth of 6 km, with reference sea level. 
This notebook demonstrates step-by-step how the model is generated within the open source modeling software `GemPy <https://www.gempy.org/>`_ [4].  
First, we will import libraries necessary to run this notebook:

.. GENERATED FROM PYTHON SOURCE LINES 29-45

.. code-block:: default


    # Importing GemPy
    import gempy as gp

    # Import improved plotting features from GemPy
    from gempy.plot import visualization_2d as vv
    from gempy.plot import vista

    # Importing auxilary libraries
    import numpy as np

    import matplotlib.pyplot as plt
    import matplotlib.image as mpimg
    import matplotlib
    matplotlib.rcParams['figure.figsize'] = (20.0, 10.0)








.. GENERATED FROM PYTHON SOURCE LINES 46-47

This example code was generated with Gempy-Version:

.. GENERATED FROM PYTHON SOURCE LINES 47-50

.. code-block:: default


    print(f"GemPy Version: {gp.__version__}")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    GemPy Version: 2.2.9




.. GENERATED FROM PYTHON SOURCE LINES 51-64

Initialize the model
 --------------------
 For modeling the PermoCarboniferous trough (**PCT**) in GemPy, we need to initialize a GemPy model object. This model object comprises multiple input data, such as interface points and orientations, 
 which we previously stored in a `.csv` file. Further, we import the topography from a GeoTiff file.  
 Conceptually, we create two models:  

.  1. With data of the the base of the PCT known  
.  2. With additional data where the base of the PCT is inferred  

 The distinction of inferred vs. known locations of the PCT is based on GeoMol 2019, an update geological model of the Swiss Molasse Basin and adjacent areas. Known and inferred parts of the PCT in 
 GeoMol can be seen `here <https://viewer.geomol.ch/webgui/gui2.php?viewHash=02171f57ee58a4082d3eb9cdc541c08b>`_.

 In this notebook, the user can choose whether only the "known" parts of the PCT base will be considered for modeling, or also the the inferred parts.

.. GENERATED FROM PYTHON SOURCE LINES 66-67

string either "known" or "inferred" to switch between model data

.. GENERATED FROM PYTHON SOURCE LINES 67-93

.. code-block:: default

    switch = "known" 

    if switch == 'known':
        # Import data - NOT INFERRED
        # Create a model instance
        geo_model = gp.create_model('PCT_model')
    
        # Initialize the model, set dimension and load interface and orientation data
        gp.init_data(geo_model, [2640000, 2685000., 1240000., 1275000., -6000, 1000.], [50, 50, 50],
                    path_i = '../../../Editorial-Transitional-Heatflow/data/processed/GemPy/00_gempy_inputs/2021-06-02_interfaces_no_fault_horizon_reduced_graben_and_mandach.csv',
                    path_o = '../../../Editorial-Transitional-Heatflow/data/processed/GemPy/00_gempy_inputs/20201007_orientations_with_Jurathrust5_no_quat_meso_reduced2.csv')
    
        geo_model.set_topography(source='gdal', filepath='../../../Editorial-Transitional-Heatflow/data/processed/GemPy/06_DTMs/DTM_200_for_GemPy_Model.tif')
    elif switch == 'inferred':
        # Import data - INFERRED
        # Create a model instance
        geo_model = gp.create_model('PCT_model_inferred')
    
        # Initialize the model, set dimension and load interface and orientation data
        gp.init_data(geo_model, [2640000, 2685000., 1240000., 1275000., -6000, 1000.], [50, 50, 50],
                    path_i = '../../data/processed/GemPy/00_gempy_inputs/20201005_interfaces_Jurathrust5_pct_inferred.csv',
                    path_o = '../../data/processed/GemPy/00_gempy_inputs/20201007_orientations_with_Jurathrust5_no_quat_meso_reduced2_pct_inferred.csv')
    
        geo_model.set_topography(source='gdal', filepath='../../data/processed/GemPy/06_DTMs/DTM_200_for_GemPy_Model.tif')






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Active grids: ['regular']
    Cropped raster to geo_model.grid.extent.
    depending on the size of the raster, this can take a while...
    storing converted file...
    Active grids: ['regular' 'topography']




.. GENERATED FROM PYTHON SOURCE LINES 94-97

To be coherent with existing geological models, e.g. geological cross-sections by nagra, we adapt the coloring for units according to 
`NTB 14-02 <https://www.nagra.ch/data/documents/database/dokumente/$default/Default\%20Folder/Publikationen/NTBs\%202014\%20-\%202015/d_ntb14-02\%20Dossier\%20I.pdf>`_ [5]. 
For this, we create a color dictionary linking the units of the model to hex-color-codes.

.. GENERATED FROM PYTHON SOURCE LINES 98-119

.. code-block:: default


    col_dict = {'basement': '#efad83',
               'graben-fill': '#97ca68',
               'Mittlerer-Muschelkalk': '#f9ee3a',
               'Oberer-Muschelkalk': '#ffcf59',
               'Keuper': '#ffe19f',
               'Opalinuston': '#7f76b4',
               'Dogger': '#b0ac67',
               'Effinger-Schichten': '#47c4e2',
               'Malm': '#92d2ec',
               'USM': '#fbf379',
               'OMM': '#fbf379',
               'BIH-Basement-N': '#015482',
               'Fault-south': '#4585a8',
               'Fault_Basement_A': '#851515',
               'Vorwald_Basement': '#b54343',
               'Jurathrust5': '#5DA629',
               'Mandach': '#408f09'}

    geo_model.surfaces.colors.change_colors(col_dict)








.. GENERATED FROM PYTHON SOURCE LINES 120-123

Visualize the data distribution
-------------------------------
The following plot shows the different interface and orientation data loaded in the previous cell:

.. GENERATED FROM PYTHON SOURCE LINES 124-127

.. code-block:: default


    gp.plot_2d(geo_model, show_data=True, show_lith=False, show_results=False, direction='z', legend=False)




.. image-sg:: /WP2-geo_modeling/images/sphx_glr_Model_PCT_GemPy_001.png
   :alt: Cell Number: mid Direction: z
   :srcset: /WP2-geo_modeling/images/sphx_glr_Model_PCT_GemPy_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <gempy.plot.visualization_2d.Plot2D object at 0x00000257B8E43C70>



.. GENERATED FROM PYTHON SOURCE LINES 128-131

The different colors in the plot represent the different model units. Circles represent the interface points, while arrows define the orientation of the respective surface in space. 

GemPy interpolates these input data in space using a universal co-kriging approach. Later on, we will set up the interpolator.

.. GENERATED FROM PYTHON SOURCE LINES 133-141

Setting up Cross sections from the Nagra Report
-----------------------------------------------

As stated before, next to GeoMol [6], we incorporate geological interpretations from four migrated seismic sections, the NAGRA report 
`NTB 14-02 <https://www.nagra.ch/data/documents/database/dokumente/$default/Default\%20Folder/Publikationen/NTBs\%202014\%20-\%202015/d_ntb14-02\%20Dossier\%20I.pdf>`_. 
For comparing the model results with the original interpretations, we define three cross sections in the model domain by specifying their start- and end-points and their resolution:

set three sections which go roughly North South:

.. GENERATED FROM PYTHON SOURCE LINES 141-148

.. code-block:: default


    section_dict = {'section4_3':([2670826,1268793],[2676862,1255579],[100,100]),
                     'section4_4':([2649021,1267107],[2659842,1246715],[100,100]),
                     'section4_8':([2643284,1259358],[2680261,1268521],[100,100])}
    geo_model.set_section_grid(section_dict)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Active grids: ['regular' 'topography' 'sections']


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>start</th>
          <th>stop</th>
          <th>resolution</th>
          <th>dist</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>section4_3</th>
          <td>[2670826, 1268793]</td>
          <td>[2676862, 1255579]</td>
          <td>[100, 100]</td>
          <td>14527.322258</td>
        </tr>
        <tr>
          <th>section4_4</th>
          <td>[2649021, 1267107]</td>
          <td>[2659842, 1246715]</td>
          <td>[100, 100]</td>
          <td>23085.226986</td>
        </tr>
        <tr>
          <th>section4_8</th>
          <td>[2643284, 1259358]</td>
          <td>[2680261, 1268521]</td>
          <td>[100, 100]</td>
          <td>38095.394709</td>
        </tr>
      </tbody>
    </table>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 149-163

Display Model Information
-------------------------

In the following, we will go through model construction step-by-step. As an overview, we display the different units (here called `surfaces`) included in the model. 
Note that also faults are surfaces within this model context. Currently, they are not marked as faults, and GemPy would treat them as the base of another geological model unit. 

To clarify, we model the base of a unit volume. That is, everything above the base surface is the respective unit, until the next base surface is reached. 
In total, our model comprises 17 `surfaces`. Everything beneath is filled with the 18th surface, called `basement`. 

### Surfaces
The majority of the structural features, i.e. normal- and thrust faults, are named following the names in GeoMol.
Main features of the model is the asymetric graben system, with the major normal faults (:code:`Fault_Basement_A`, :code:`Fault-south`, :code:`BIH-Basement-N`), 
and the graben fill, which is not present beyond the graben shoulders, unless where it is inferred. 
This, as well as the stop of major normal faults beneath the mesozoic units (the base of :code:`Mittlerer-Muschelkalk`) are important considerations for the modeling process. 

.. GENERATED FROM PYTHON SOURCE LINES 163-167

.. code-block:: default


    geo_model.surfaces







.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <style  type="text/css" >
    #T_22f04_row0_col3{
                background-color:  #015482;
            }#T_22f04_row1_col3{
                background-color:  #b0ac67;
            }#T_22f04_row2_col3{
                background-color:  #47c4e2;
            }#T_22f04_row3_col3{
                background-color:  #851515;
            }#T_22f04_row4_col3{
                background-color:  #4585a8;
            }#T_22f04_row5_col3{
                background-color:  #5DA629;
            }#T_22f04_row6_col3{
                background-color:  #ffe19f;
            }#T_22f04_row7_col3{
                background-color:  #92d2ec;
            }#T_22f04_row8_col3{
                background-color:  #408f09;
            }#T_22f04_row9_col3{
                background-color:  #f9ee3a;
            }#T_22f04_row10_col3{
                background-color:  #ffcf59;
            }#T_22f04_row11_col3,#T_22f04_row13_col3{
                background-color:  #fbf379;
            }#T_22f04_row12_col3{
                background-color:  #7f76b4;
            }#T_22f04_row14_col3{
                background-color:  #b54343;
            }#T_22f04_row15_col3{
                background-color:  #97ca68;
            }#T_22f04_row16_col3{
                background-color:  #efad83;
            }</style><table id="T_22f04_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                    <tr>
                            <th id="T_22f04_level0_row0" class="row_heading level0 row0" >0</th>
                            <td id="T_22f04_row0_col0" class="data row0 col0" >BIH-Basement-N</td>
                            <td id="T_22f04_row0_col1" class="data row0 col1" >Default series</td>
                            <td id="T_22f04_row0_col2" class="data row0 col2" >1</td>
                            <td id="T_22f04_row0_col3" class="data row0 col3" >#015482</td>
                            <td id="T_22f04_row0_col4" class="data row0 col4" >1</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row1" class="row_heading level0 row1" >1</th>
                            <td id="T_22f04_row1_col0" class="data row1 col0" >Dogger</td>
                            <td id="T_22f04_row1_col1" class="data row1 col1" >Default series</td>
                            <td id="T_22f04_row1_col2" class="data row1 col2" >2</td>
                            <td id="T_22f04_row1_col3" class="data row1 col3" >#b0ac67</td>
                            <td id="T_22f04_row1_col4" class="data row1 col4" >2</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row2" class="row_heading level0 row2" >2</th>
                            <td id="T_22f04_row2_col0" class="data row2 col0" >Effinger-Schichten</td>
                            <td id="T_22f04_row2_col1" class="data row2 col1" >Default series</td>
                            <td id="T_22f04_row2_col2" class="data row2 col2" >3</td>
                            <td id="T_22f04_row2_col3" class="data row2 col3" >#47c4e2</td>
                            <td id="T_22f04_row2_col4" class="data row2 col4" >3</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row3" class="row_heading level0 row3" >3</th>
                            <td id="T_22f04_row3_col0" class="data row3 col0" >Fault_Basement_A</td>
                            <td id="T_22f04_row3_col1" class="data row3 col1" >Default series</td>
                            <td id="T_22f04_row3_col2" class="data row3 col2" >4</td>
                            <td id="T_22f04_row3_col3" class="data row3 col3" >#851515</td>
                            <td id="T_22f04_row3_col4" class="data row3 col4" >4</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row4" class="row_heading level0 row4" >4</th>
                            <td id="T_22f04_row4_col0" class="data row4 col0" >Fault-south</td>
                            <td id="T_22f04_row4_col1" class="data row4 col1" >Default series</td>
                            <td id="T_22f04_row4_col2" class="data row4 col2" >5</td>
                            <td id="T_22f04_row4_col3" class="data row4 col3" >#4585a8</td>
                            <td id="T_22f04_row4_col4" class="data row4 col4" >5</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row5" class="row_heading level0 row5" >5</th>
                            <td id="T_22f04_row5_col0" class="data row5 col0" >Jurathrust5</td>
                            <td id="T_22f04_row5_col1" class="data row5 col1" >Default series</td>
                            <td id="T_22f04_row5_col2" class="data row5 col2" >6</td>
                            <td id="T_22f04_row5_col3" class="data row5 col3" >#5DA629</td>
                            <td id="T_22f04_row5_col4" class="data row5 col4" >6</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row6" class="row_heading level0 row6" >6</th>
                            <td id="T_22f04_row6_col0" class="data row6 col0" >Keuper</td>
                            <td id="T_22f04_row6_col1" class="data row6 col1" >Default series</td>
                            <td id="T_22f04_row6_col2" class="data row6 col2" >7</td>
                            <td id="T_22f04_row6_col3" class="data row6 col3" >#ffe19f</td>
                            <td id="T_22f04_row6_col4" class="data row6 col4" >7</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row7" class="row_heading level0 row7" >7</th>
                            <td id="T_22f04_row7_col0" class="data row7 col0" >Malm</td>
                            <td id="T_22f04_row7_col1" class="data row7 col1" >Default series</td>
                            <td id="T_22f04_row7_col2" class="data row7 col2" >8</td>
                            <td id="T_22f04_row7_col3" class="data row7 col3" >#92d2ec</td>
                            <td id="T_22f04_row7_col4" class="data row7 col4" >8</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row8" class="row_heading level0 row8" >8</th>
                            <td id="T_22f04_row8_col0" class="data row8 col0" >Mandach</td>
                            <td id="T_22f04_row8_col1" class="data row8 col1" >Default series</td>
                            <td id="T_22f04_row8_col2" class="data row8 col2" >9</td>
                            <td id="T_22f04_row8_col3" class="data row8 col3" >#408f09</td>
                            <td id="T_22f04_row8_col4" class="data row8 col4" >9</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row9" class="row_heading level0 row9" >9</th>
                            <td id="T_22f04_row9_col0" class="data row9 col0" >Mittlerer-Muschelkalk</td>
                            <td id="T_22f04_row9_col1" class="data row9 col1" >Default series</td>
                            <td id="T_22f04_row9_col2" class="data row9 col2" >10</td>
                            <td id="T_22f04_row9_col3" class="data row9 col3" >#f9ee3a</td>
                            <td id="T_22f04_row9_col4" class="data row9 col4" >10</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row10" class="row_heading level0 row10" >10</th>
                            <td id="T_22f04_row10_col0" class="data row10 col0" >Oberer-Muschelkalk</td>
                            <td id="T_22f04_row10_col1" class="data row10 col1" >Default series</td>
                            <td id="T_22f04_row10_col2" class="data row10 col2" >11</td>
                            <td id="T_22f04_row10_col3" class="data row10 col3" >#ffcf59</td>
                            <td id="T_22f04_row10_col4" class="data row10 col4" >11</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row11" class="row_heading level0 row11" >11</th>
                            <td id="T_22f04_row11_col0" class="data row11 col0" >OMM</td>
                            <td id="T_22f04_row11_col1" class="data row11 col1" >Default series</td>
                            <td id="T_22f04_row11_col2" class="data row11 col2" >12</td>
                            <td id="T_22f04_row11_col3" class="data row11 col3" >#fbf379</td>
                            <td id="T_22f04_row11_col4" class="data row11 col4" >12</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row12" class="row_heading level0 row12" >12</th>
                            <td id="T_22f04_row12_col0" class="data row12 col0" >Opalinuston</td>
                            <td id="T_22f04_row12_col1" class="data row12 col1" >Default series</td>
                            <td id="T_22f04_row12_col2" class="data row12 col2" >13</td>
                            <td id="T_22f04_row12_col3" class="data row12 col3" >#7f76b4</td>
                            <td id="T_22f04_row12_col4" class="data row12 col4" >13</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row13" class="row_heading level0 row13" >13</th>
                            <td id="T_22f04_row13_col0" class="data row13 col0" >USM</td>
                            <td id="T_22f04_row13_col1" class="data row13 col1" >Default series</td>
                            <td id="T_22f04_row13_col2" class="data row13 col2" >14</td>
                            <td id="T_22f04_row13_col3" class="data row13 col3" >#fbf379</td>
                            <td id="T_22f04_row13_col4" class="data row13 col4" >14</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row14" class="row_heading level0 row14" >14</th>
                            <td id="T_22f04_row14_col0" class="data row14 col0" >Vorwald_Basement</td>
                            <td id="T_22f04_row14_col1" class="data row14 col1" >Default series</td>
                            <td id="T_22f04_row14_col2" class="data row14 col2" >15</td>
                            <td id="T_22f04_row14_col3" class="data row14 col3" >#b54343</td>
                            <td id="T_22f04_row14_col4" class="data row14 col4" >15</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row15" class="row_heading level0 row15" >15</th>
                            <td id="T_22f04_row15_col0" class="data row15 col0" >graben-fill</td>
                            <td id="T_22f04_row15_col1" class="data row15 col1" >Default series</td>
                            <td id="T_22f04_row15_col2" class="data row15 col2" >16</td>
                            <td id="T_22f04_row15_col3" class="data row15 col3" >#97ca68</td>
                            <td id="T_22f04_row15_col4" class="data row15 col4" >16</td>
                </tr>
                <tr>
                            <th id="T_22f04_level0_row16" class="row_heading level0 row16" >16</th>
                            <td id="T_22f04_row16_col0" class="data row16 col0" >basement</td>
                            <td id="T_22f04_row16_col1" class="data row16 col1" >Basement</td>
                            <td id="T_22f04_row16_col2" class="data row16 col2" >1</td>
                            <td id="T_22f04_row16_col3" class="data row16 col3" >#efad83</td>
                            <td id="T_22f04_row16_col4" class="data row16 col4" >17</td>
                </tr>
        </tbody></table>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 168-177

Characteristics  
---------------
One characteristic seen in the table above, is that all surfaces are assigned to a :code:`series` called :code:`Default series`. 
A _series_ in GemPy indicates whether units should be interpolated using the same parameters. That is, all :code:`surfaces` within the same :code:`series` will be sub-parallel. 
Thus, surfaces have to be grouped into different series, depending on their geometry in space. For instance, sub-parallel layers of a sedimentary sequence should be grouped in the same series, 
while an unconformity, or a fault should be assorted to its own series. 

In this model, we group the majority of mesozoic and cenozoic units in one series, called :code:`Post_graben_series`. Only the mesozoic surface :code:`Mittlerer-Muschelkalk` will be assigned its own 
series, as it forms the basal detachement of the Jura Mountains. Palaeozoic graben sediments are also assigned its own series.

.. GENERATED FROM PYTHON SOURCE LINES 177-202

.. code-block:: default


    # Assign formations to series
    gp.map_series_to_surfaces(geo_model,
                             {"Thrust_Mandach": 'Mandach',
                              "Thrust_Jura": 'Jurathrust5',
                              #"Thrust_Jura6": 'Jurathrust6', #('Jurathrust4', 'Jurathrust5', 'Jurathrust6'),
                              "Fault_north_series": 'Fault_Basement_A',
                              "Fault_south_series": 'Fault-south',
                              "Vorwald_series": 'Vorwald_Basement',
                              "BIH_series": 'BIH-Basement-N',
                              "Fault_north_series": 'Fault_Basement_A',
                              "Fault_south_series": 'Fault-south',
                             "Post_graben_series": ('OMM',
                                                    'USM',
                                                    'Malm',
                                                    'Effinger-Schichten',
                                                    'Dogger', 
                                                    'Opalinuston', 
                                                    'Keuper',
                                                    'Oberer-Muschelkalk'),
                              "Detachement": 'Mittlerer-Muschelkalk',
                             "Graben_series": 'graben-fill'},
                             remove_unused_series=True)
    geo_model.surfaces






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <style  type="text/css" >
    #T_73c35_row0_col3{
                background-color:  #408f09;
            }#T_73c35_row1_col3{
                background-color:  #5DA629;
            }#T_73c35_row2_col3{
                background-color:  #851515;
            }#T_73c35_row3_col3{
                background-color:  #4585a8;
            }#T_73c35_row4_col3{
                background-color:  #b54343;
            }#T_73c35_row5_col3{
                background-color:  #015482;
            }#T_73c35_row6_col3{
                background-color:  #b0ac67;
            }#T_73c35_row7_col3{
                background-color:  #47c4e2;
            }#T_73c35_row8_col3{
                background-color:  #ffe19f;
            }#T_73c35_row9_col3{
                background-color:  #92d2ec;
            }#T_73c35_row10_col3{
                background-color:  #ffcf59;
            }#T_73c35_row11_col3,#T_73c35_row13_col3{
                background-color:  #fbf379;
            }#T_73c35_row12_col3{
                background-color:  #7f76b4;
            }#T_73c35_row14_col3{
                background-color:  #f9ee3a;
            }#T_73c35_row15_col3{
                background-color:  #97ca68;
            }#T_73c35_row16_col3{
                background-color:  #efad83;
            }</style><table id="T_73c35_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                    <tr>
                            <th id="T_73c35_level0_row0" class="row_heading level0 row0" >8</th>
                            <td id="T_73c35_row0_col0" class="data row0 col0" >Mandach</td>
                            <td id="T_73c35_row0_col1" class="data row0 col1" >Thrust_Mandach</td>
                            <td id="T_73c35_row0_col2" class="data row0 col2" >1</td>
                            <td id="T_73c35_row0_col3" class="data row0 col3" >#408f09</td>
                            <td id="T_73c35_row0_col4" class="data row0 col4" >1</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row1" class="row_heading level0 row1" >5</th>
                            <td id="T_73c35_row1_col0" class="data row1 col0" >Jurathrust5</td>
                            <td id="T_73c35_row1_col1" class="data row1 col1" >Thrust_Jura</td>
                            <td id="T_73c35_row1_col2" class="data row1 col2" >1</td>
                            <td id="T_73c35_row1_col3" class="data row1 col3" >#5DA629</td>
                            <td id="T_73c35_row1_col4" class="data row1 col4" >2</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row2" class="row_heading level0 row2" >3</th>
                            <td id="T_73c35_row2_col0" class="data row2 col0" >Fault_Basement_A</td>
                            <td id="T_73c35_row2_col1" class="data row2 col1" >Fault_north_series</td>
                            <td id="T_73c35_row2_col2" class="data row2 col2" >1</td>
                            <td id="T_73c35_row2_col3" class="data row2 col3" >#851515</td>
                            <td id="T_73c35_row2_col4" class="data row2 col4" >3</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row3" class="row_heading level0 row3" >4</th>
                            <td id="T_73c35_row3_col0" class="data row3 col0" >Fault-south</td>
                            <td id="T_73c35_row3_col1" class="data row3 col1" >Fault_south_series</td>
                            <td id="T_73c35_row3_col2" class="data row3 col2" >1</td>
                            <td id="T_73c35_row3_col3" class="data row3 col3" >#4585a8</td>
                            <td id="T_73c35_row3_col4" class="data row3 col4" >4</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row4" class="row_heading level0 row4" >14</th>
                            <td id="T_73c35_row4_col0" class="data row4 col0" >Vorwald_Basement</td>
                            <td id="T_73c35_row4_col1" class="data row4 col1" >Vorwald_series</td>
                            <td id="T_73c35_row4_col2" class="data row4 col2" >1</td>
                            <td id="T_73c35_row4_col3" class="data row4 col3" >#b54343</td>
                            <td id="T_73c35_row4_col4" class="data row4 col4" >5</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row5" class="row_heading level0 row5" >0</th>
                            <td id="T_73c35_row5_col0" class="data row5 col0" >BIH-Basement-N</td>
                            <td id="T_73c35_row5_col1" class="data row5 col1" >BIH_series</td>
                            <td id="T_73c35_row5_col2" class="data row5 col2" >1</td>
                            <td id="T_73c35_row5_col3" class="data row5 col3" >#015482</td>
                            <td id="T_73c35_row5_col4" class="data row5 col4" >6</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row6" class="row_heading level0 row6" >1</th>
                            <td id="T_73c35_row6_col0" class="data row6 col0" >Dogger</td>
                            <td id="T_73c35_row6_col1" class="data row6 col1" >Post_graben_series</td>
                            <td id="T_73c35_row6_col2" class="data row6 col2" >1</td>
                            <td id="T_73c35_row6_col3" class="data row6 col3" >#b0ac67</td>
                            <td id="T_73c35_row6_col4" class="data row6 col4" >7</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row7" class="row_heading level0 row7" >2</th>
                            <td id="T_73c35_row7_col0" class="data row7 col0" >Effinger-Schichten</td>
                            <td id="T_73c35_row7_col1" class="data row7 col1" >Post_graben_series</td>
                            <td id="T_73c35_row7_col2" class="data row7 col2" >2</td>
                            <td id="T_73c35_row7_col3" class="data row7 col3" >#47c4e2</td>
                            <td id="T_73c35_row7_col4" class="data row7 col4" >8</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row8" class="row_heading level0 row8" >6</th>
                            <td id="T_73c35_row8_col0" class="data row8 col0" >Keuper</td>
                            <td id="T_73c35_row8_col1" class="data row8 col1" >Post_graben_series</td>
                            <td id="T_73c35_row8_col2" class="data row8 col2" >3</td>
                            <td id="T_73c35_row8_col3" class="data row8 col3" >#ffe19f</td>
                            <td id="T_73c35_row8_col4" class="data row8 col4" >9</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row9" class="row_heading level0 row9" >7</th>
                            <td id="T_73c35_row9_col0" class="data row9 col0" >Malm</td>
                            <td id="T_73c35_row9_col1" class="data row9 col1" >Post_graben_series</td>
                            <td id="T_73c35_row9_col2" class="data row9 col2" >4</td>
                            <td id="T_73c35_row9_col3" class="data row9 col3" >#92d2ec</td>
                            <td id="T_73c35_row9_col4" class="data row9 col4" >10</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row10" class="row_heading level0 row10" >10</th>
                            <td id="T_73c35_row10_col0" class="data row10 col0" >Oberer-Muschelkalk</td>
                            <td id="T_73c35_row10_col1" class="data row10 col1" >Post_graben_series</td>
                            <td id="T_73c35_row10_col2" class="data row10 col2" >5</td>
                            <td id="T_73c35_row10_col3" class="data row10 col3" >#ffcf59</td>
                            <td id="T_73c35_row10_col4" class="data row10 col4" >11</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row11" class="row_heading level0 row11" >11</th>
                            <td id="T_73c35_row11_col0" class="data row11 col0" >OMM</td>
                            <td id="T_73c35_row11_col1" class="data row11 col1" >Post_graben_series</td>
                            <td id="T_73c35_row11_col2" class="data row11 col2" >6</td>
                            <td id="T_73c35_row11_col3" class="data row11 col3" >#fbf379</td>
                            <td id="T_73c35_row11_col4" class="data row11 col4" >12</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row12" class="row_heading level0 row12" >12</th>
                            <td id="T_73c35_row12_col0" class="data row12 col0" >Opalinuston</td>
                            <td id="T_73c35_row12_col1" class="data row12 col1" >Post_graben_series</td>
                            <td id="T_73c35_row12_col2" class="data row12 col2" >7</td>
                            <td id="T_73c35_row12_col3" class="data row12 col3" >#7f76b4</td>
                            <td id="T_73c35_row12_col4" class="data row12 col4" >13</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row13" class="row_heading level0 row13" >13</th>
                            <td id="T_73c35_row13_col0" class="data row13 col0" >USM</td>
                            <td id="T_73c35_row13_col1" class="data row13 col1" >Post_graben_series</td>
                            <td id="T_73c35_row13_col2" class="data row13 col2" >8</td>
                            <td id="T_73c35_row13_col3" class="data row13 col3" >#fbf379</td>
                            <td id="T_73c35_row13_col4" class="data row13 col4" >14</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row14" class="row_heading level0 row14" >9</th>
                            <td id="T_73c35_row14_col0" class="data row14 col0" >Mittlerer-Muschelkalk</td>
                            <td id="T_73c35_row14_col1" class="data row14 col1" >Detachement</td>
                            <td id="T_73c35_row14_col2" class="data row14 col2" >1</td>
                            <td id="T_73c35_row14_col3" class="data row14 col3" >#f9ee3a</td>
                            <td id="T_73c35_row14_col4" class="data row14 col4" >15</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row15" class="row_heading level0 row15" >15</th>
                            <td id="T_73c35_row15_col0" class="data row15 col0" >graben-fill</td>
                            <td id="T_73c35_row15_col1" class="data row15 col1" >Graben_series</td>
                            <td id="T_73c35_row15_col2" class="data row15 col2" >1</td>
                            <td id="T_73c35_row15_col3" class="data row15 col3" >#97ca68</td>
                            <td id="T_73c35_row15_col4" class="data row15 col4" >16</td>
                </tr>
                <tr>
                            <th id="T_73c35_level0_row16" class="row_heading level0 row16" >16</th>
                            <td id="T_73c35_row16_col0" class="data row16 col0" >basement</td>
                            <td id="T_73c35_row16_col1" class="data row16 col1" >Basement</td>
                            <td id="T_73c35_row16_col2" class="data row16 col2" >1</td>
                            <td id="T_73c35_row16_col3" class="data row16 col3" >#efad83</td>
                            <td id="T_73c35_row16_col4" class="data row16 col4" >17</td>
                </tr>
        </tbody></table>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 203-207

Define Faults
-------------
To distinguish between lithological units and faults, we have to assign which series are faults. Faults can be infinite, i.e. have the same displacement throughout the model space, or they can be
finite, meaning displacement will be less towards the fault edges (which are defined by the extent of interface points used as input).

.. GENERATED FROM PYTHON SOURCE LINES 208-215

.. code-block:: default


    geo_model.set_is_fault(['Thrust_Mandach', 'Thrust_Jura', 'Fault_north_series', 
                            'Fault_south_series', 'Vorwald_series', 'BIH_series'],
                          change_color=False)
    geo_model.set_is_finite_fault(series_fault=['BIH_series', 'Vorwald_series'],
                                  toggle=True)






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>order_series</th>
          <th>BottomRelation</th>
          <th>isActive</th>
          <th>isFault</th>
          <th>isFinite</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>Thrust_Mandach</th>
          <td>1</td>
          <td>Fault</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Thrust_Jura</th>
          <td>2</td>
          <td>Fault</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Fault_north_series</th>
          <td>3</td>
          <td>Fault</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Fault_south_series</th>
          <td>4</td>
          <td>Fault</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Vorwald_series</th>
          <td>5</td>
          <td>Fault</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
        </tr>
        <tr>
          <th>BIH_series</th>
          <td>6</td>
          <td>Fault</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
        </tr>
        <tr>
          <th>Post_graben_series</th>
          <td>7</td>
          <td>Erosion</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Detachement</th>
          <td>8</td>
          <td>Erosion</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Graben_series</th>
          <td>9</td>
          <td>Erosion</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Basement</th>
          <td>10</td>
          <td>Erosion</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
        </tr>
      </tbody>
    </table>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 216-221

Bottom relation 
---------------
To set whether a surface is eroding or not, we can set a series' `bottom_relation`. Per default, it is set to `Erosion`, meaning the base of a younger surface (higher up in the stratigraphic pile) 
will cut through older surfaces. Setting the `bottom_relation` to `Onlap` will cause the opposite, i.e. younger surfaces stop on older ones.  
We set the _Graben_series_ to onlap, as most of it is only present in the graben, i.e. hanging wall of the normal faults, but not in the foot wall.

.. GENERATED FROM PYTHON SOURCE LINES 221-224

.. code-block:: default


    geo_model.set_bottom_relation(series=['Graben_series'], bottom_relation='Onlap')






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>order_series</th>
          <th>BottomRelation</th>
          <th>isActive</th>
          <th>isFault</th>
          <th>isFinite</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>Thrust_Mandach</th>
          <td>1</td>
          <td>Fault</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Thrust_Jura</th>
          <td>2</td>
          <td>Fault</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Fault_north_series</th>
          <td>3</td>
          <td>Fault</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Fault_south_series</th>
          <td>4</td>
          <td>Fault</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Vorwald_series</th>
          <td>5</td>
          <td>Fault</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
        </tr>
        <tr>
          <th>BIH_series</th>
          <td>6</td>
          <td>Fault</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
        </tr>
        <tr>
          <th>Post_graben_series</th>
          <td>7</td>
          <td>Erosion</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Detachement</th>
          <td>8</td>
          <td>Erosion</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Graben_series</th>
          <td>9</td>
          <td>Onlap</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Basement</th>
          <td>10</td>
          <td>Erosion</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
        </tr>
      </tbody>
    </table>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 225-233

Define Fault relations
----------------------
With cross-cutting faults, we need to define fault relations, i.e. which fault stops at which. This is important, as some normal faults stop at others, e.g. :code:`BIH_Series` stops at 
:code:`Fault_south_series`. Fault relations are set in a matrix, where :code:`True` sets that one fault stops at the other. If set to :code:`False` (the default), faults cross-cut each other 
without any effects.

Further, fault relations are used to define whether a fault displaces lithological series, or not. Per default, all faults displace the lithological series, but not other faults. 
This can be seen, if we plot the :code:`fault_relations` matrix:

.. GENERATED FROM PYTHON SOURCE LINES 233-236

.. code-block:: default


    geo_model.faults.faults_relations_df






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>Thrust_Mandach</th>
          <th>Thrust_Jura</th>
          <th>Fault_north_series</th>
          <th>Fault_south_series</th>
          <th>Vorwald_series</th>
          <th>BIH_series</th>
          <th>Post_graben_series</th>
          <th>Detachement</th>
          <th>Graben_series</th>
          <th>Basement</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>Thrust_Mandach</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
        </tr>
        <tr>
          <th>Thrust_Jura</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
        </tr>
        <tr>
          <th>Fault_north_series</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
        </tr>
        <tr>
          <th>Fault_south_series</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
        </tr>
        <tr>
          <th>Vorwald_series</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
        </tr>
        <tr>
          <th>BIH_series</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
        </tr>
        <tr>
          <th>Post_graben_series</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Detachement</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Graben_series</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Basement</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 237-245

We know that faults do not affect all lithological series equally. For instance, thrusts will not affect the paleozoic sediments filling the graben. 
Just as the mesozoic units are not affected by the normal faults. Thus we set up a fault relation matrix, considering:  

- thrusts only affect Mesozoic units    
- normal faults only affect Basement, Graben_series  
- normal faults stop at thrusts
We can update the fault relations by creating a boolean matrix of shape similar to :code:`faults_relations_df`, to assign which fault displaces which unit, etc. Then we use this
boolean matrix to set fault relations using the :code:`set_fault_relation()` method.

.. GENERATED FROM PYTHON SOURCE LINES 245-258

.. code-block:: default


    fr = np.array([[False, False, False, False, False, False, True,  False, False, False],
                   [False, False, False, True,  False, False, True,  False, False, False],
                   [False, False, False, False, True,  False,  False, True,  True, True],
                   [False, False, False, False, False, True, False, False,  True, True],
                   [False, False, False, False, False, False, False, True,  True, True],
                   [False, False, False, False, False, False, False, False, True, True],
                   [False, False, False, False, False, False, False, False, False, False],
                   [False, False, False, False, False, False, False, False, False, False],
                   [False, False, False, False, False, False, False, False, False, False],
                   [False, False, False, False, False, False, False, False, False, False]])
    geo_model.set_fault_relation(fr)






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>Thrust_Mandach</th>
          <th>Thrust_Jura</th>
          <th>Fault_north_series</th>
          <th>Fault_south_series</th>
          <th>Vorwald_series</th>
          <th>BIH_series</th>
          <th>Post_graben_series</th>
          <th>Detachement</th>
          <th>Graben_series</th>
          <th>Basement</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>Thrust_Mandach</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Thrust_Jura</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Fault_north_series</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
        </tr>
        <tr>
          <th>Fault_south_series</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
        </tr>
        <tr>
          <th>Vorwald_series</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
        </tr>
        <tr>
          <th>BIH_series</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
        </tr>
        <tr>
          <th>Post_graben_series</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Detachement</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Graben_series</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>Basement</th>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 259-260

Remember when we had a look at the input data and briefly mentioned the interpolator? We now set the interpolator function for the underlying co-kriging interpolation using theano:

.. GENERATED FROM PYTHON SOURCE LINES 260-266

.. code-block:: default


    gp.set_interpolator(geo_model,
                             compile_theano=True,
                             theano_optimizer='fast_compile',
                             verbose=[])





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Setting kriging parameters to their default values.
    Compiling theano function...
    Level of Optimization:  fast_compile
    Device:  cpu
    Precision:  float64
    Number of faults:  6
    Compilation Done!
    Kriging values: 
                                              values
    range                              57436.921923
    $C_o$                           78547619.047619
    drift equations  [3, 3, 3, 3, 3, 3, 3, 3, 3, 3]

    <gempy.core.interpolator.InterpolatorModel object at 0x00000257B8873340>



.. GENERATED FROM PYTHON SOURCE LINES 267-271

Creating the model
------------------
Now that we set the parameters and fault relations, it is time to start the modeling process. In Gempy, this is done using a single function :code:`gempy.comput_model` giving the prepared _geo_model_ 
as input.

.. GENERATED FROM PYTHON SOURCE LINES 271-274

.. code-block:: default


    sol = gp.compute_model(geo_model, compute_mesh=True)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    C:\Users\brigg\miniconda3\envs\env_gempyP38\lib\site-packages\gempy\core\solution.py:174: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
      self.geological_map = np.array(
    C:\Users\brigg\miniconda3\envs\env_gempyP38\lib\site-packages\gempy\core\solution.py:179: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
      self.sections = np.array(




.. GENERATED FROM PYTHON SOURCE LINES 275-279

For comparing model results with geological interpretations of the aforementioned seismic sections, we plot the model units on top of the seismic profiles. 
Profiles 4.3 and 4.4 (nomenclature is taken from [1]) strike across the graben axis, while profile 4.8 goes roughly along the graben.

In the following plot, we model all profiles with the resulting geological grid, in the order from left to right: Profile 4.3, Profile 4.4, Profile 4.8.

.. GENERATED FROM PYTHON SOURCE LINES 279-283

.. code-block:: default


    gp.plot_2d(geo_model, section_names=list(section_dict), show_block=True, show_boundaries=False, show_data=False,
              show_topography=True, show_results=True)




.. image-sg:: /WP2-geo_modeling/images/sphx_glr_Model_PCT_GemPy_002.png
   :alt: section4_3, section4_4, section4_8
   :srcset: /WP2-geo_modeling/images/sphx_glr_Model_PCT_GemPy_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <gempy.plot.visualization_2d.Plot2D object at 0x00000257B8F819A0>



.. GENERATED FROM PYTHON SOURCE LINES 284-291

References
----------
[1]: Naef, H., and Madritsch, H.: Tektonische Karte des Nordschweizer Permokarbontrogs: Aktualisierung basierend auf 2D-Seismik und Schweredaten. Nagra Arbeitsbericht NAB 14-017, (2014).  
[2]: Gmnder, C., Malaguerra, F., Nusch, S., & Traber, D.: Regional Hydrogeo-logical Model of Northern Switzerland. Nagra Arbeitsbericht NAB, 13-23, (2014).  
[3]: Luo, J., Monninkhoff, B., Becker J.K.: Hydrogeological model Jura Ost. Nagra Arbeitsbericht NAB, 13-26, (2014).  
[4]: de la Varga, M., Schaaf, A., and Wellmann, F.: GemPy 1.0: Open-source stochastic geological modeling and inversion. Geoscientific Model Development, 12(1), (2019), 1. doi:http://dx.doi.org/10.5194/gmd-12-1-2019.  
[5]: Gautschi, A., & Zuidema, P. (ed): Nagra technical report 14-02, geological basics-Dossier I-Introduction and summary; SGT Etappe 2: Vorschlag weiter zu untersuchender geologischer Standortgebiete mit zugehrigen Standortarealen fr die Oberflchenanlage--Geologische Grundlagen--Dossier I--Einleitung und Zusammenfassung, (2014).  
[6]: GeoMol Team (2015): GeoMol  Assessing subsurface potentials of the Alpine Foreland Basins for sustainable planning and use of natural resources  Project Report, 188 pp. (Augsburg, LfU).  


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 3 minutes  28.618 seconds)


.. _sphx_glr_download_WP2-geo_modeling_Model_PCT_GemPy.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: Model_PCT_GemPy.py <Model_PCT_GemPy.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: Model_PCT_GemPy.ipynb <Model_PCT_GemPy.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
