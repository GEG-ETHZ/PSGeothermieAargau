
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Geological model creation and gravity simulation &#8212; Pilot Study Geothermie Aargau ALPHA documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-wp2-geo-modeling-01-poc-generate-model-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="geological-model-creation-and-gravity-simulation">
<span id="sphx-glr-wp2-geo-modeling-01-poc-generate-model-py"></span><h1>Geological model creation and gravity simulation<a class="headerlink" href="#geological-model-creation-and-gravity-simulation" title="Permalink to this headline">¶</a></h1>
<p>The following tutorial will step-by-step lead you through an example workflow on creating a GemPy model from interface and orientation data, assigning densities to geological units,
and model their gravity response.</p>
<div class="section" id="create-the-base-proof-of-concept-model">
<h2>Create the base Proof-of-Concept Model<a class="headerlink" href="#create-the-base-proof-of-concept-model" title="Permalink to this headline">¶</a></h2>
<p>Based on a seismic section from the NAGRA report <a class="reference external" href="https://www.nagra.ch/data/documents/database/dokumente/$default/Default%20Folder/Publikationen/NABs%202004%20-%202015/d_nab14-017.pdf">NAGRA NAB 14-17</a> [1], we extracted interface and orientation points for lithological units and faults.</p>
<p>The lithological units comprise the permo-carboniferous filling (divided in three stages based on the report results), Mesozoic, Tertiary, and Quaternary strata, as well as the Palaeozoic crystalline basement rocks.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<a href="https://docs.python.org/3/library/warnings.html#warnings.filterwarnings" title="warnings.filterwarnings" class="sphx-glr-backref-module-warnings sphx-glr-backref-type-py-function"><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span></a><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Importing GemPy</span>
<span class="kn">import</span> <span class="nn">gempy</span> <span class="k">as</span> <span class="nn">gp</span>
<span class="kn">from</span> <span class="nn">gempy.plot</span> <span class="kn">import</span> <span class="n">visualization_2d</span> <span class="k">as</span> <span class="n">vv</span>

<span class="c1"># Importing auxilary libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-talk&#39;</span><span class="p">)</span>

<span class="c1"># What GemPy version was used</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Code run with GemPy version: </span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gp</span><span class="o">.</span><span class="n">__version__</span></a><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Code run with GemPy version: 2.2.9
</pre></div>
</div>
</div>
<div class="section" id="initialize-the-model">
<h2>Initialize the model<a class="headerlink" href="#initialize-the-model" title="Permalink to this headline">¶</a></h2>
<p>We start with modelling the trough by generating a gempy model object. This will use interface points and orientations, which we previously stored in a <cite>.csv</cite> file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fix random number seed to get the same topography</span>
<a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="numpy.random.seed" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="mi">333</span><span class="p">)</span>
<span class="c1"># Import data</span>
<span class="c1"># Create a model instance</span>
<span class="n">geo_model</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s1">&#39;POC_model&#39;</span><span class="p">)</span>

<span class="c1"># Initialize the model, set dimension and load interface and orientation data</span>
<span class="n">gp</span><span class="o">.</span><span class="n">init_data</span><span class="p">(</span><span class="n">geo_model</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">28000.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">14000.</span><span class="p">,</span> <span class="o">-</span><span class="mi">6500</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
            <span class="n">path_i</span> <span class="o">=</span> <span class="s1">&#39;../../data/GemPy/line82_interfaces_wo_middle_MC.csv&#39;</span><span class="p">,</span>
            <span class="n">path_o</span> <span class="o">=</span> <span class="s1">&#39;../../data/GemPy/line82_foliations_wo_middle_MC.csv&#39;</span><span class="p">)</span>
<span class="n">geo_model</span><span class="o">.</span><span class="n">set_topography</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">d_z</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">300</span><span class="p">,</span><span class="mi">1000</span><span class="p">]))</span>

<span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span><span class="p">(</span><span class="n">geo_model</span><span class="p">,</span> <span class="n">show_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_topography</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Cell Number: mid Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_01_POC_generate-model_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Active grids: [&#39;regular&#39;]
Active grids: [&#39;regular&#39; &#39;topography&#39;]

&lt;gempy.plot.visualization_2d.Plot2D object at 0x000001FACCFC68B0&gt;
</pre></div>
</div>
</div>
<div class="section" id="adding-information-to-the-model">
<h2>Adding information to the model<a class="headerlink" href="#adding-information-to-the-model" title="Permalink to this headline">¶</a></h2>
<p>Only loading interface and orientation points is not enough. First, let’s assign colors to the different model units, e.g. for coloring faults similarly.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">col_dict</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;basement&#39;</span><span class="p">:</span> <span class="s1">&#39;#c7848f&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Lower-filling&#39;</span><span class="p">:</span> <span class="s1">&#39;#a5d490&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Upper-filling&#39;</span><span class="p">:</span> <span class="s1">&#39;#cfc199&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Unconformity&#39;</span><span class="p">:</span> <span class="s1">&#39;#725c9a&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Orange&#39;</span><span class="p">:</span> <span class="s1">&#39;#ff792b&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Pink&#39;</span><span class="p">:</span> <span class="s1">&#39;#e588f3&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Tertiary&#39;</span><span class="p">:</span> <span class="s1">&#39;#dbdbac&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Fault2&#39;</span><span class="p">:</span> <span class="s1">&#39;#015482&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Fault5&#39;</span><span class="p">:</span> <span class="s1">&#39;#015482&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Fault6&#39;</span><span class="p">:</span> <span class="s1">&#39;#015482&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Thrust1_south&#39;</span><span class="p">:</span> <span class="s1">&#39;#5DA629&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Thrust2_south&#39;</span><span class="p">:</span> <span class="s1">&#39;#5DA629&#39;</span><span class="p">}</span>
<span class="n">geo_model</span><span class="o">.</span><span class="n">surfaces</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">change_colors</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">col_dict</span></a><span class="p">)</span>
<span class="n">geo_model</span><span class="o">.</span><span class="n">surfaces</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style  type="text/css" >
    #T_a237e502_e325_11eb_8f9c_00e04c6800carow0_col3 {
            background-color:  #015482;
        }    #T_a237e502_e325_11eb_8f9c_00e04c6800carow1_col3 {
            background-color:  #015482;
        }    #T_a237e502_e325_11eb_8f9c_00e04c6800carow2_col3 {
            background-color:  #015482;
        }    #T_a237e502_e325_11eb_8f9c_00e04c6800carow3_col3 {
            background-color:  #a5d490;
        }    #T_a237e502_e325_11eb_8f9c_00e04c6800carow4_col3 {
            background-color:  #cfc199;
        }    #T_a237e502_e325_11eb_8f9c_00e04c6800carow5_col3 {
            background-color:  #725c9a;
        }    #T_a237e502_e325_11eb_8f9c_00e04c6800carow6_col3 {
            background-color:  #dbdbac;
        }    #T_a237e502_e325_11eb_8f9c_00e04c6800carow7_col3 {
            background-color:  #ff792b;
        }    #T_a237e502_e325_11eb_8f9c_00e04c6800carow8_col3 {
            background-color:  #e588f3;
        }    #T_a237e502_e325_11eb_8f9c_00e04c6800carow9_col3 {
            background-color:  #5DA629;
        }    #T_a237e502_e325_11eb_8f9c_00e04c6800carow10_col3 {
            background-color:  #5DA629;
        }    #T_a237e502_e325_11eb_8f9c_00e04c6800carow11_col3 {
            background-color:  #c7848f;
        }</style><table id="T_a237e502_e325_11eb_8f9c_00e04c6800ca" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_a237e502_e325_11eb_8f9c_00e04c6800calevel0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow0_col0" class="data row0 col0" >Fault2</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow0_col1" class="data row0 col1" >Default series</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow0_col2" class="data row0 col2" >1</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow0_col3" class="data row0 col3" >#015482</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow0_col4" class="data row0 col4" >1</td>
            </tr>
            <tr>
                        <th id="T_a237e502_e325_11eb_8f9c_00e04c6800calevel0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow1_col0" class="data row1 col0" >Fault5</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow1_col1" class="data row1 col1" >Default series</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow1_col2" class="data row1 col2" >2</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow1_col3" class="data row1 col3" >#015482</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow1_col4" class="data row1 col4" >2</td>
            </tr>
            <tr>
                        <th id="T_a237e502_e325_11eb_8f9c_00e04c6800calevel0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow2_col0" class="data row2 col0" >Fault6</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow2_col1" class="data row2 col1" >Default series</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow2_col2" class="data row2 col2" >3</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow2_col3" class="data row2 col3" >#015482</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow2_col4" class="data row2 col4" >3</td>
            </tr>
            <tr>
                        <th id="T_a237e502_e325_11eb_8f9c_00e04c6800calevel0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow3_col0" class="data row3 col0" >Lower-filling</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow3_col1" class="data row3 col1" >Default series</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow3_col2" class="data row3 col2" >4</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow3_col3" class="data row3 col3" >#a5d490</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow3_col4" class="data row3 col4" >4</td>
            </tr>
            <tr>
                        <th id="T_a237e502_e325_11eb_8f9c_00e04c6800calevel0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow4_col0" class="data row4 col0" >Upper-filling</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow4_col1" class="data row4 col1" >Default series</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow4_col2" class="data row4 col2" >5</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow4_col3" class="data row4 col3" >#cfc199</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow4_col4" class="data row4 col4" >5</td>
            </tr>
            <tr>
                        <th id="T_a237e502_e325_11eb_8f9c_00e04c6800calevel0_row5" class="row_heading level0 row5" >5</th>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow5_col0" class="data row5 col0" >Unconformity</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow5_col1" class="data row5 col1" >Default series</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow5_col2" class="data row5 col2" >6</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow5_col3" class="data row5 col3" >#725c9a</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow5_col4" class="data row5 col4" >6</td>
            </tr>
            <tr>
                        <th id="T_a237e502_e325_11eb_8f9c_00e04c6800calevel0_row6" class="row_heading level0 row6" >6</th>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow6_col0" class="data row6 col0" >Tertiary</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow6_col1" class="data row6 col1" >Default series</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow6_col2" class="data row6 col2" >7</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow6_col3" class="data row6 col3" >#dbdbac</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow6_col4" class="data row6 col4" >7</td>
            </tr>
            <tr>
                        <th id="T_a237e502_e325_11eb_8f9c_00e04c6800calevel0_row7" class="row_heading level0 row7" >7</th>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow7_col0" class="data row7 col0" >Orange</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow7_col1" class="data row7 col1" >Default series</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow7_col2" class="data row7 col2" >8</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow7_col3" class="data row7 col3" >#ff792b</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow7_col4" class="data row7 col4" >8</td>
            </tr>
            <tr>
                        <th id="T_a237e502_e325_11eb_8f9c_00e04c6800calevel0_row8" class="row_heading level0 row8" >8</th>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow8_col0" class="data row8 col0" >Pink</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow8_col1" class="data row8 col1" >Default series</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow8_col2" class="data row8 col2" >9</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow8_col3" class="data row8 col3" >#e588f3</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow8_col4" class="data row8 col4" >9</td>
            </tr>
            <tr>
                        <th id="T_a237e502_e325_11eb_8f9c_00e04c6800calevel0_row9" class="row_heading level0 row9" >9</th>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow9_col0" class="data row9 col0" >Thrust1_south</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow9_col1" class="data row9 col1" >Default series</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow9_col2" class="data row9 col2" >10</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow9_col3" class="data row9 col3" >#5DA629</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow9_col4" class="data row9 col4" >10</td>
            </tr>
            <tr>
                        <th id="T_a237e502_e325_11eb_8f9c_00e04c6800calevel0_row10" class="row_heading level0 row10" >10</th>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow10_col0" class="data row10 col0" >Thrust2_south</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow10_col1" class="data row10 col1" >Default series</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow10_col2" class="data row10 col2" >11</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow10_col3" class="data row10 col3" >#5DA629</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow10_col4" class="data row10 col4" >11</td>
            </tr>
            <tr>
                        <th id="T_a237e502_e325_11eb_8f9c_00e04c6800calevel0_row11" class="row_heading level0 row11" >11</th>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow11_col0" class="data row11 col0" >basement</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow11_col1" class="data row11 col1" >Basement</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow11_col2" class="data row11 col2" >1</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow11_col3" class="data row11 col3" >#c7848f</td>
                        <td id="T_a237e502_e325_11eb_8f9c_00e04c6800carow11_col4" class="data row11 col4" >12</td>
            </tr>
    </tbody></table>
</div>
<br />
<br /></div>
<div class="section" id="model-characteristics">
<h2>Model Characteristics<a class="headerlink" href="#model-characteristics" title="Permalink to this headline">¶</a></h2>
<p>Main features of the model is the asymetric graben system, with the major fault (denoted with <strong>A</strong>), and the graben fill, which is not present beyond the graben shoulders. This, as well as the stop of major faults beneath the mesozoic units (blue units) are important considerations for the modelling process.
These could be caught, for instance, in likelihood functions if we model the PCT as a Bayesian inference problem.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assign formations to series</span>
<span class="n">gp</span><span class="o">.</span><span class="n">map_series_to_surfaces</span><span class="p">(</span><span class="n">geo_model</span><span class="p">,</span>
                         <span class="p">{</span><span class="s2">&quot;Thrust1_series&quot;</span><span class="p">:</span> <span class="s1">&#39;Thrust1_south&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Thrust2_series&quot;</span><span class="p">:</span> <span class="s1">&#39;Thrust2_south&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Fault2_series&quot;</span><span class="p">:</span> <span class="s1">&#39;Fault2&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Fault5_series&quot;</span><span class="p">:</span> <span class="s1">&#39;Fault5&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Fault6_series&quot;</span><span class="p">:</span> <span class="s1">&#39;Fault6&#39;</span><span class="p">,</span>
                         <span class="s2">&quot;Post_tectonic_series&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Tertiary&#39;</span><span class="p">,</span> <span class="s1">&#39;Pink&#39;</span><span class="p">,</span> <span class="s1">&#39;Orange&#39;</span><span class="p">),</span>
                          <span class="s2">&quot;Detachement&quot;</span><span class="p">:</span> <span class="s1">&#39;Unconformity&#39;</span><span class="p">,</span>
                         <span class="s2">&quot;Syn_tectonic_series2&quot;</span><span class="p">:</span> <span class="s1">&#39;Upper-filling&#39;</span><span class="p">,</span>
                         <span class="c1">#&quot;Syn_tectonic_series1&quot;: &#39;Middle-filling&#39;,</span>
                         <span class="s2">&quot;Pre_tectonic_series&quot;</span><span class="p">:</span> <span class="s1">&#39;Lower-filling&#39;</span><span class="p">},</span>
                         <span class="n">remove_unused_series</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">geo_model</span><span class="o">.</span><span class="n">surfaces</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style  type="text/css" >
    #T_a26117b4_e325_11eb_955b_00e04c6800carow0_col3 {
            background-color:  #5DA629;
        }    #T_a26117b4_e325_11eb_955b_00e04c6800carow1_col3 {
            background-color:  #5DA629;
        }    #T_a26117b4_e325_11eb_955b_00e04c6800carow2_col3 {
            background-color:  #015482;
        }    #T_a26117b4_e325_11eb_955b_00e04c6800carow3_col3 {
            background-color:  #015482;
        }    #T_a26117b4_e325_11eb_955b_00e04c6800carow4_col3 {
            background-color:  #015482;
        }    #T_a26117b4_e325_11eb_955b_00e04c6800carow5_col3 {
            background-color:  #dbdbac;
        }    #T_a26117b4_e325_11eb_955b_00e04c6800carow6_col3 {
            background-color:  #ff792b;
        }    #T_a26117b4_e325_11eb_955b_00e04c6800carow7_col3 {
            background-color:  #e588f3;
        }    #T_a26117b4_e325_11eb_955b_00e04c6800carow8_col3 {
            background-color:  #725c9a;
        }    #T_a26117b4_e325_11eb_955b_00e04c6800carow9_col3 {
            background-color:  #cfc199;
        }    #T_a26117b4_e325_11eb_955b_00e04c6800carow10_col3 {
            background-color:  #a5d490;
        }    #T_a26117b4_e325_11eb_955b_00e04c6800carow11_col3 {
            background-color:  #c7848f;
        }</style><table id="T_a26117b4_e325_11eb_955b_00e04c6800ca" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_a26117b4_e325_11eb_955b_00e04c6800calevel0_row0" class="row_heading level0 row0" >9</th>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow0_col0" class="data row0 col0" >Thrust1_south</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow0_col1" class="data row0 col1" >Thrust1_series</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow0_col2" class="data row0 col2" >1</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow0_col3" class="data row0 col3" >#5DA629</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow0_col4" class="data row0 col4" >1</td>
            </tr>
            <tr>
                        <th id="T_a26117b4_e325_11eb_955b_00e04c6800calevel0_row1" class="row_heading level0 row1" >10</th>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow1_col0" class="data row1 col0" >Thrust2_south</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow1_col1" class="data row1 col1" >Thrust2_series</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow1_col2" class="data row1 col2" >1</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow1_col3" class="data row1 col3" >#5DA629</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow1_col4" class="data row1 col4" >2</td>
            </tr>
            <tr>
                        <th id="T_a26117b4_e325_11eb_955b_00e04c6800calevel0_row2" class="row_heading level0 row2" >0</th>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow2_col0" class="data row2 col0" >Fault2</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow2_col1" class="data row2 col1" >Fault2_series</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow2_col2" class="data row2 col2" >1</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow2_col3" class="data row2 col3" >#015482</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow2_col4" class="data row2 col4" >3</td>
            </tr>
            <tr>
                        <th id="T_a26117b4_e325_11eb_955b_00e04c6800calevel0_row3" class="row_heading level0 row3" >1</th>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow3_col0" class="data row3 col0" >Fault5</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow3_col1" class="data row3 col1" >Fault5_series</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow3_col2" class="data row3 col2" >1</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow3_col3" class="data row3 col3" >#015482</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow3_col4" class="data row3 col4" >4</td>
            </tr>
            <tr>
                        <th id="T_a26117b4_e325_11eb_955b_00e04c6800calevel0_row4" class="row_heading level0 row4" >2</th>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow4_col0" class="data row4 col0" >Fault6</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow4_col1" class="data row4 col1" >Fault6_series</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow4_col2" class="data row4 col2" >1</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow4_col3" class="data row4 col3" >#015482</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow4_col4" class="data row4 col4" >5</td>
            </tr>
            <tr>
                        <th id="T_a26117b4_e325_11eb_955b_00e04c6800calevel0_row5" class="row_heading level0 row5" >6</th>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow5_col0" class="data row5 col0" >Tertiary</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow5_col1" class="data row5 col1" >Post_tectonic_series</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow5_col2" class="data row5 col2" >1</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow5_col3" class="data row5 col3" >#dbdbac</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow5_col4" class="data row5 col4" >6</td>
            </tr>
            <tr>
                        <th id="T_a26117b4_e325_11eb_955b_00e04c6800calevel0_row6" class="row_heading level0 row6" >7</th>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow6_col0" class="data row6 col0" >Orange</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow6_col1" class="data row6 col1" >Post_tectonic_series</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow6_col2" class="data row6 col2" >2</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow6_col3" class="data row6 col3" >#ff792b</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow6_col4" class="data row6 col4" >7</td>
            </tr>
            <tr>
                        <th id="T_a26117b4_e325_11eb_955b_00e04c6800calevel0_row7" class="row_heading level0 row7" >8</th>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow7_col0" class="data row7 col0" >Pink</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow7_col1" class="data row7 col1" >Post_tectonic_series</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow7_col2" class="data row7 col2" >3</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow7_col3" class="data row7 col3" >#e588f3</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow7_col4" class="data row7 col4" >8</td>
            </tr>
            <tr>
                        <th id="T_a26117b4_e325_11eb_955b_00e04c6800calevel0_row8" class="row_heading level0 row8" >5</th>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow8_col0" class="data row8 col0" >Unconformity</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow8_col1" class="data row8 col1" >Detachement</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow8_col2" class="data row8 col2" >1</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow8_col3" class="data row8 col3" >#725c9a</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow8_col4" class="data row8 col4" >9</td>
            </tr>
            <tr>
                        <th id="T_a26117b4_e325_11eb_955b_00e04c6800calevel0_row9" class="row_heading level0 row9" >4</th>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow9_col0" class="data row9 col0" >Upper-filling</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow9_col1" class="data row9 col1" >Syn_tectonic_series2</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow9_col2" class="data row9 col2" >1</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow9_col3" class="data row9 col3" >#cfc199</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow9_col4" class="data row9 col4" >10</td>
            </tr>
            <tr>
                        <th id="T_a26117b4_e325_11eb_955b_00e04c6800calevel0_row10" class="row_heading level0 row10" >3</th>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow10_col0" class="data row10 col0" >Lower-filling</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow10_col1" class="data row10 col1" >Pre_tectonic_series</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow10_col2" class="data row10 col2" >1</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow10_col3" class="data row10 col3" >#a5d490</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow10_col4" class="data row10 col4" >11</td>
            </tr>
            <tr>
                        <th id="T_a26117b4_e325_11eb_955b_00e04c6800calevel0_row11" class="row_heading level0 row11" >11</th>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow11_col0" class="data row11 col0" >basement</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow11_col1" class="data row11 col1" >Basement</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow11_col2" class="data row11 col2" >1</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow11_col3" class="data row11 col3" >#c7848f</td>
                        <td id="T_a26117b4_e325_11eb_955b_00e04c6800carow11_col4" class="data row11 col4" >12</td>
            </tr>
    </tbody></table>
</div>
<br />
<br /><p>After assigning units to stacks or series, we have so define which of those series is a fault. Here, we see that it is usually important to assign each fault its own series, as faults may have very different
scalar fields (in which the fault surfaces are interpolated).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geo_model</span><span class="o">.</span><span class="n">set_is_fault</span><span class="p">([</span><span class="s1">&#39;Thrust1_series&#39;</span><span class="p">,</span> <span class="s1">&#39;Thrust2_series&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Fault2_series&#39;</span><span class="p">,</span> <span class="s1">&#39;Fault5_series&#39;</span><span class="p">,</span> <span class="s1">&#39;Fault6_series&#39;</span><span class="p">],</span>
                      <span class="n">change_color</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_series</th>
      <th>BottomRelation</th>
      <th>isActive</th>
      <th>isFault</th>
      <th>isFinite</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Thrust1_series</th>
      <td>1</td>
      <td>Fault</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Thrust2_series</th>
      <td>2</td>
      <td>Fault</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Fault2_series</th>
      <td>3</td>
      <td>Fault</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Fault5_series</th>
      <td>4</td>
      <td>Fault</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Fault6_series</th>
      <td>5</td>
      <td>Fault</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Post_tectonic_series</th>
      <td>6</td>
      <td>Erosion</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Detachement</th>
      <td>7</td>
      <td>Erosion</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Syn_tectonic_series2</th>
      <td>8</td>
      <td>Erosion</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Pre_tectonic_series</th>
      <td>9</td>
      <td>Erosion</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Basement</th>
      <td>10</td>
      <td>Erosion</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Further we have to set bottom relations, if a series is <strong>not</strong> erosive. For instance, the Units in the Graben are most likely onlapping units.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geo_model</span><span class="o">.</span><span class="n">set_bottom_relation</span><span class="p">(</span><span class="n">series</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Post_tectonic_series&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;Pre_tectonic_series&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;Syn_tectonic_series2&#39;</span><span class="p">],</span> <span class="n">bottom_relation</span><span class="o">=</span><span class="s1">&#39;Onlap&#39;</span><span class="p">)</span> <span class="c1">#,</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_series</th>
      <th>BottomRelation</th>
      <th>isActive</th>
      <th>isFault</th>
      <th>isFinite</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Thrust1_series</th>
      <td>1</td>
      <td>Fault</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Thrust2_series</th>
      <td>2</td>
      <td>Fault</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Fault2_series</th>
      <td>3</td>
      <td>Fault</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Fault5_series</th>
      <td>4</td>
      <td>Fault</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Fault6_series</th>
      <td>5</td>
      <td>Fault</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Post_tectonic_series</th>
      <td>6</td>
      <td>Onlap</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Detachement</th>
      <td>7</td>
      <td>Erosion</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Syn_tectonic_series2</th>
      <td>8</td>
      <td>Onlap</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Pre_tectonic_series</th>
      <td>9</td>
      <td>Onlap</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Basement</th>
      <td>10</td>
      <td>Erosion</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>The following table shows the fault relations, i.e. which unit (or fault) is affected by a fault. If the respective entry in the table is set to <cite>True</cite>, the fault on the left displaces the unit (or fault) in a respective
column.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geo_model</span><span class="o">.</span><span class="n">faults</span><span class="o">.</span><span class="n">faults_relations_df</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Thrust1_series</th>
      <th>Thrust2_series</th>
      <th>Fault2_series</th>
      <th>Fault5_series</th>
      <th>Fault6_series</th>
      <th>Post_tectonic_series</th>
      <th>Detachement</th>
      <th>Syn_tectonic_series2</th>
      <th>Pre_tectonic_series</th>
      <th>Basement</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Thrust1_series</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>Thrust2_series</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>Fault2_series</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>Fault5_series</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>Fault6_series</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>Post_tectonic_series</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Detachement</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Syn_tectonic_series2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Pre_tectonic_series</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Basement</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<br />
<br /><p>Per default, faults displace all lithological units. However, the normal faults of the graben do not affect the younger units, so we define a boolean matrix, which  sets the fault relations correctly.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fr</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
               <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>  <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
               <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
               <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
               <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
               <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
               <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
               <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
               <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
               <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]])</span>
<span class="n">geo_model</span><span class="o">.</span><span class="n">set_fault_relation</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fr</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Thrust1_series</th>
      <th>Thrust2_series</th>
      <th>Fault2_series</th>
      <th>Fault5_series</th>
      <th>Fault6_series</th>
      <th>Post_tectonic_series</th>
      <th>Detachement</th>
      <th>Syn_tectonic_series2</th>
      <th>Pre_tectonic_series</th>
      <th>Basement</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Thrust1_series</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Thrust2_series</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Fault2_series</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>Fault5_series</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>Fault6_series</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>Post_tectonic_series</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Detachement</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Syn_tectonic_series2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Pre_tectonic_series</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Basement</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<br />
<br /></div>
<div class="section" id="creating-the-model">
<h2>Creating the model<a class="headerlink" href="#creating-the-model" title="Permalink to this headline">¶</a></h2>
<p>Now that we set the parameters and fault relations, it is time to start the modeling process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># decrease the kriging range</span>
<span class="n">geo_model</span><span class="o">.</span><span class="n">modify_kriging_parameters</span><span class="p">(</span><span class="s1">&#39;range&#39;</span><span class="p">,</span> <span class="mf">20000.</span><span class="p">)</span>
<span class="n">geo_model</span><span class="o">.</span><span class="n">modify_kriging_parameters</span><span class="p">(</span><span class="s1">&#39;$C_o$&#39;</span><span class="p">,</span> <span class="mf">2e5</span><span class="p">)</span>

<span class="c1"># Set the interpolator function</span>
<span class="n">gp</span><span class="o">.</span><span class="n">set_interpolator</span><span class="p">(</span><span class="n">geo_model</span><span class="p">,</span>
                         <span class="n">compile_theano</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">theano_optimizer</span><span class="o">=</span><span class="s1">&#39;fast_compile&#39;</span><span class="p">,</span>
                         <span class="n">verbose</span><span class="o">=</span><span class="p">[],</span>
                         <span class="n">update_kriging</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Compute the model</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span><span class="p">(</span><span class="n">geo_model</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Compiling theano function...
Level of Optimization:  fast_compile
Device:  cpu
Precision:  float64
Number of faults:  5
Compilation Done!
Kriging values:
                                          values
range                                     20000
$C_o$                                    200000
drift equations  [3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
</pre></div>
</div>
<p>Saving the model is straight forward. It can optionally also be compressed in a zip archive, or be _pickled_. An example on how to save a model is shown next. There, we give the saving path and the model name.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geo_model</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;POC_PCT_model&#39;</span><span class="p">,</span>
                     <span class="n">path</span><span class="o">=</span><span class="s1">&#39;../../models/2021-06-04_POC_base_model&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
<p>Let’s have a look how the created model looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span><span class="p">(</span><span class="n">geo_model</span><span class="p">,</span> <span class="n">cell_number</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">show_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_topography</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">show_lith</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_boundaries</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Cell Number: 25 Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_01_POC_generate-model_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.visualization_2d.Plot2D object at 0x000001FACEF36040&gt;
</pre></div>
</div>
</div>
</div>
<div class="section" id="simulate-gravity">
<h1>Simulate Gravity<a class="headerlink" href="#simulate-gravity" title="Permalink to this headline">¶</a></h1>
<p>Using the now generated POC-model, we simulate its gravity at different locations. These locations will be treated as observations later on in the workflow.
In a first step, we distribute 15 points randomly across the topography of our model. Those will be the station locations, where we pick up the gravity signal of the POC-model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># distribute stations</span>
<span class="kn">import</span> <span class="nn">random</span>
<a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="numpy.random.seed" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="mi">58</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_indices</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.randint.html#numpy.random.randint" title="numpy.random.randint" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">4999</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_coordinates</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">topography</span><span class="o">.</span><span class="n">values</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_indices</span></a><span class="p">,</span> <span class="p">:]</span>

<a href="https://matplotlib.org/api/collections_api.html#matplotlib.collections.PathCollection" title="matplotlib.collections.PathCollection" class="sphx-glr-backref-module-matplotlib-collections sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cs</span></a> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.scatter.html#matplotlib.pyplot.scatter" title="matplotlib.pyplot.scatter" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_coordinates</span></a><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_coordinates</span></a><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_coordinates</span></a><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><a href="https://matplotlib.org/api/collections_api.html#matplotlib.collections.PathCollection" title="matplotlib.collections.PathCollection" class="sphx-glr-backref-module-matplotlib-collections sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cs</span></a><span class="p">)</span>
</pre></div>
</div>
<img alt="01 POC generate model" class="sphx-glr-single-img" src="../_images/sphx_glr_01_POC_generate-model_003.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.colorbar.Colorbar object at 0x000001FAD46F4DC0&gt;
</pre></div>
</div>
<p>Next, we create centered grids around each station. The centered grid here has 10 cells in x- and y-direction, and extends 15 cells down in the z-direction.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gempy.assets.geophysics</span> <span class="kn">import</span> <span class="n">GravityPreprocessing</span>
<span class="n">geo_model</span><span class="o">.</span><span class="n">set_centered_grid</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_coordinates</span></a><span class="p">,</span>  <span class="n">resolution</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">radius</span><span class="o">=</span><span class="mi">6000</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">GravityPreprocessing</span><span class="p">(</span><span class="n">geo_model</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">centered_grid</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tz</span></a> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">set_tz_kernel</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Active grids: [&#39;regular&#39; &#39;topography&#39; &#39;centered&#39;]
</pre></div>
</div>
<p>The gravity response cannot be modeled without assigning a density to the model units. Theoretically, one could also assign different petrophyiscal properties here. They will be
added as separate columns to the surfaces dataframe.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">densities</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">2.466</span><span class="p">,</span> <span class="mf">2.61</span><span class="p">,</span> <span class="mf">2.53</span><span class="p">,</span>
             <span class="mf">2.61</span><span class="p">,</span> <span class="mf">2.47</span><span class="p">,</span> <span class="mf">2.55</span><span class="p">,</span> <span class="mf">2.67</span><span class="p">]</span>
<span class="n">geo_model</span><span class="o">.</span><span class="n">add_surface_values</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">densities</span></a><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style  type="text/css" >
    #T_bcf6d162_e325_11eb_aef7_00e04c6800carow0_col3 {
            background-color:  #5DA629;
        }    #T_bcf6d162_e325_11eb_aef7_00e04c6800carow1_col3 {
            background-color:  #5DA629;
        }    #T_bcf6d162_e325_11eb_aef7_00e04c6800carow2_col3 {
            background-color:  #015482;
        }    #T_bcf6d162_e325_11eb_aef7_00e04c6800carow3_col3 {
            background-color:  #015482;
        }    #T_bcf6d162_e325_11eb_aef7_00e04c6800carow4_col3 {
            background-color:  #015482;
        }    #T_bcf6d162_e325_11eb_aef7_00e04c6800carow5_col3 {
            background-color:  #dbdbac;
        }    #T_bcf6d162_e325_11eb_aef7_00e04c6800carow6_col3 {
            background-color:  #e588f3;
        }    #T_bcf6d162_e325_11eb_aef7_00e04c6800carow7_col3 {
            background-color:  #ff792b;
        }    #T_bcf6d162_e325_11eb_aef7_00e04c6800carow8_col3 {
            background-color:  #725c9a;
        }    #T_bcf6d162_e325_11eb_aef7_00e04c6800carow9_col3 {
            background-color:  #cfc199;
        }    #T_bcf6d162_e325_11eb_aef7_00e04c6800carow10_col3 {
            background-color:  #a5d490;
        }    #T_bcf6d162_e325_11eb_aef7_00e04c6800carow11_col3 {
            background-color:  #c7848f;
        }</style><table id="T_bcf6d162_e325_11eb_aef7_00e04c6800ca" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>        <th class="col_heading level0 col5" >density</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_bcf6d162_e325_11eb_aef7_00e04c6800calevel0_row0" class="row_heading level0 row0" >9</th>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow0_col0" class="data row0 col0" >Thrust1_south</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow0_col1" class="data row0 col1" >Thrust1_series</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow0_col2" class="data row0 col2" >1</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow0_col3" class="data row0 col3" >#5DA629</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow0_col4" class="data row0 col4" >1</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow0_col5" class="data row0 col5" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_bcf6d162_e325_11eb_aef7_00e04c6800calevel0_row1" class="row_heading level0 row1" >10</th>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow1_col0" class="data row1 col0" >Thrust2_south</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow1_col1" class="data row1 col1" >Thrust2_series</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow1_col2" class="data row1 col2" >1</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow1_col3" class="data row1 col3" >#5DA629</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow1_col4" class="data row1 col4" >2</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow1_col5" class="data row1 col5" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_bcf6d162_e325_11eb_aef7_00e04c6800calevel0_row2" class="row_heading level0 row2" >0</th>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow2_col0" class="data row2 col0" >Fault2</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow2_col1" class="data row2 col1" >Fault2_series</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow2_col2" class="data row2 col2" >1</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow2_col3" class="data row2 col3" >#015482</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow2_col4" class="data row2 col4" >3</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow2_col5" class="data row2 col5" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_bcf6d162_e325_11eb_aef7_00e04c6800calevel0_row3" class="row_heading level0 row3" >1</th>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow3_col0" class="data row3 col0" >Fault5</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow3_col1" class="data row3 col1" >Fault5_series</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow3_col2" class="data row3 col2" >1</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow3_col3" class="data row3 col3" >#015482</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow3_col4" class="data row3 col4" >4</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow3_col5" class="data row3 col5" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_bcf6d162_e325_11eb_aef7_00e04c6800calevel0_row4" class="row_heading level0 row4" >2</th>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow4_col0" class="data row4 col0" >Fault6</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow4_col1" class="data row4 col1" >Fault6_series</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow4_col2" class="data row4 col2" >1</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow4_col3" class="data row4 col3" >#015482</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow4_col4" class="data row4 col4" >5</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow4_col5" class="data row4 col5" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_bcf6d162_e325_11eb_aef7_00e04c6800calevel0_row5" class="row_heading level0 row5" >6</th>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow5_col0" class="data row5 col0" >Tertiary</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow5_col1" class="data row5 col1" >Post_tectonic_series</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow5_col2" class="data row5 col2" >1</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow5_col3" class="data row5 col3" >#dbdbac</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow5_col4" class="data row5 col4" >6</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow5_col5" class="data row5 col5" >2.466000</td>
            </tr>
            <tr>
                        <th id="T_bcf6d162_e325_11eb_aef7_00e04c6800calevel0_row6" class="row_heading level0 row6" >8</th>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow6_col0" class="data row6 col0" >Pink</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow6_col1" class="data row6 col1" >Post_tectonic_series</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow6_col2" class="data row6 col2" >2</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow6_col3" class="data row6 col3" >#e588f3</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow6_col4" class="data row6 col4" >7</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow6_col5" class="data row6 col5" >2.610000</td>
            </tr>
            <tr>
                        <th id="T_bcf6d162_e325_11eb_aef7_00e04c6800calevel0_row7" class="row_heading level0 row7" >7</th>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow7_col0" class="data row7 col0" >Orange</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow7_col1" class="data row7 col1" >Post_tectonic_series</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow7_col2" class="data row7 col2" >3</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow7_col3" class="data row7 col3" >#ff792b</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow7_col4" class="data row7 col4" >8</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow7_col5" class="data row7 col5" >2.530000</td>
            </tr>
            <tr>
                        <th id="T_bcf6d162_e325_11eb_aef7_00e04c6800calevel0_row8" class="row_heading level0 row8" >5</th>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow8_col0" class="data row8 col0" >Unconformity</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow8_col1" class="data row8 col1" >Detachement</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow8_col2" class="data row8 col2" >1</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow8_col3" class="data row8 col3" >#725c9a</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow8_col4" class="data row8 col4" >9</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow8_col5" class="data row8 col5" >2.610000</td>
            </tr>
            <tr>
                        <th id="T_bcf6d162_e325_11eb_aef7_00e04c6800calevel0_row9" class="row_heading level0 row9" >4</th>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow9_col0" class="data row9 col0" >Upper-filling</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow9_col1" class="data row9 col1" >Syn_tectonic_series2</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow9_col2" class="data row9 col2" >1</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow9_col3" class="data row9 col3" >#cfc199</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow9_col4" class="data row9 col4" >10</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow9_col5" class="data row9 col5" >2.470000</td>
            </tr>
            <tr>
                        <th id="T_bcf6d162_e325_11eb_aef7_00e04c6800calevel0_row10" class="row_heading level0 row10" >3</th>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow10_col0" class="data row10 col0" >Lower-filling</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow10_col1" class="data row10 col1" >Pre_tectonic_series</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow10_col2" class="data row10 col2" >1</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow10_col3" class="data row10 col3" >#a5d490</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow10_col4" class="data row10 col4" >11</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow10_col5" class="data row10 col5" >2.550000</td>
            </tr>
            <tr>
                        <th id="T_bcf6d162_e325_11eb_aef7_00e04c6800calevel0_row11" class="row_heading level0 row11" >11</th>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow11_col0" class="data row11 col0" >basement</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow11_col1" class="data row11 col1" >Basement</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow11_col2" class="data row11 col2" >1</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow11_col3" class="data row11 col3" >#c7848f</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow11_col4" class="data row11 col4" >12</td>
                        <td id="T_bcf6d162_e325_11eb_aef7_00e04c6800carow11_col5" class="data row11 col5" >2.670000</td>
            </tr>
    </tbody></table>
</div>
<br />
<br /><p>Modeling the lithology on all grids (regular, topography, centered) can get time consuming. So here, we only activate the centered grid to catch the gravity response.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geo_model</span><span class="o">.</span><span class="n">set_active_grid</span><span class="p">(</span><span class="s1">&#39;centered&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">gp</span><span class="o">.</span><span class="n">set_interpolator</span><span class="p">(</span><span class="n">geo_model</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gravity&#39;</span><span class="p">],</span> <span class="n">theano_optimizer</span><span class="o">=</span><span class="s1">&#39;fast_run&#39;</span><span class="p">,</span> <span class="n">update_kriging</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span><span class="p">(</span><span class="n">geo_model</span><span class="p">)</span>
<span class="c1"># reshape solved gravity and add coordinates</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grav</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sol</span><span class="o">.</span><span class="n">fw_gravity</span></a>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grav1</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grav</span></a><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grav</span></a><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_forw_grav</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.append.html#numpy.append" title="numpy.append" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">append</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_coordinates</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grav1</span></a><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>
<span class="c1"># make everything into a dataframe</span>
<span class="n">df_stations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_forw_grav</span></a><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="s2">&quot;grav&quot;</span><span class="p">])</span>
<span class="c1"># round X Y and Z to 2 decimals</span>
<span class="n">df_stations</span><span class="p">[[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">]]</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.around.html#numpy.around" title="numpy.around" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">around</span></a><span class="p">(</span><span class="n">df_stations</span><span class="p">[[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">]],</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Active grids: [&#39;centered&#39;]
Compiling theano function...
Level of Optimization:  fast_run
Device:  cpu
Precision:  float64
Number of faults:  5
Compilation Done!
Kriging values:
                                          values
range                                     20000
$C_o$                                    200000
drift equations  [3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
</pre></div>
</div>
<p>and finally, we save the modeled gravity to be used as observations later on:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_stations</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../../data/Data_for_MC/20210322_forw_grav_seed58.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>[1] Naef, H., &amp; Madritsch, H. (2014). Tektonische Karte des Nordschweizer Permokarbontrogs: Aktualisierung basierend auf 2D-Seismik und Schweredaten. Nagra Arbeitsbericht (NAB 14-17). Wettingen: Nagra.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  53.679 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-wp2-geo-modeling-01-poc-generate-model-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/fef86c750c2b6abe7e7620070e68162b/01_POC_generate-model.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">01_POC_generate-model.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/c0df2aee345dd272f309e96f7c15d8ce/01_POC_generate-model.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">01_POC_generate-model.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/ps_aargau_logo_200px.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">Pilot Study Geothermie Aargau</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=Japhiolite&repo=PSGeothermieAargau&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the_project.html">The project</a></li>
</ul>
<p class="caption"><span class="caption-text">Galleries:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../WP1data_analysis/index.html">Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WP2geo_modeling/index.html">Geological Model</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019 - 2021, Jan Niederau.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/WP2-geo_modeling/01_POC_generate-model.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>