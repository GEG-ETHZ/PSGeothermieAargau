
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Monte Carlo simulation &#8212; Pilot Study Geothermie Aargau ALPHA documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-wp2-geo-modeling-02-poc-create-mc-ensemble-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="monte-carlo-simulation">
<span id="sphx-glr-wp2-geo-modeling-02-poc-create-mc-ensemble-py"></span><h1>Monte Carlo simulation<a class="headerlink" href="#monte-carlo-simulation" title="Permalink to this headline">¶</a></h1>
<p>The following tutorial will lead you through an example workflow on how to create a Monte Carlo simulation of
geological models, meaning we will produce different geological geometries and also simulate their gravity
response.</p>
<div class="section" id="importing-libraries">
<h2>Importing libraries<a class="headerlink" href="#importing-libraries" title="Permalink to this headline">¶</a></h2>
<p>First things first: let’s import necessary libraries.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<a href="https://docs.python.org/3/library/warnings.html#warnings.filterwarnings" title="warnings.filterwarnings" class="sphx-glr-backref-module-warnings sphx-glr-backref-type-py-function"><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span></a><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Importing GemPy</span>
<span class="kn">import</span> <span class="nn">gempy</span> <span class="k">as</span> <span class="nn">gp</span>
<span class="kn">from</span> <span class="nn">gempy.assets</span> <span class="kn">import</span> <span class="n">topology</span> <span class="k">as</span> <span class="n">tp</span>
<span class="kn">from</span> <span class="nn">gempy.bayesian.fields</span> <span class="kn">import</span> <span class="n">compute_prob</span><span class="p">,</span> <span class="n">calculate_ie_masked</span>
<span class="kn">from</span> <span class="nn">gempy.assets.geophysics</span> <span class="kn">import</span> <span class="n">GravityPreprocessing</span>

<span class="c1"># Importing auxilary libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-talk&#39;</span><span class="p">)</span>

<span class="c1">#import sys</span>
<span class="c1">#sys.path.append(&#39;../../OpenWF/&#39;)</span>
<span class="c1">#from aux_functions import log_progress</span>

<span class="c1"># Check gempy version used for running the code</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Code run with GemPy version: </span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gp</span><span class="o">.</span><span class="n">__version__</span></a><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Code run with GemPy version: 2.2.9
</pre></div>
</div>
</div>
<div class="section" id="model-initialization">
<h2>Model Initialization<a class="headerlink" href="#model-initialization" title="Permalink to this headline">¶</a></h2>
<p>First, we import the base Proof-of-Concept model (POC-model from here on), which was generated in the previous example. Using the loading method of GemPy <cite>gp.load_model()</cite> directly loads the model’s input, already set with fault relations, surfaces assigned to a stack (series), etc.
Only thing left is to recompile and run the model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model_path</span></a> <span class="o">=</span> <span class="s1">&#39;../../models/2021-06-04_POC_base_model&#39;</span>

<span class="n">geo_model</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;POC_PCT_model&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model_path</span></a><span class="p">,</span>
                         <span class="n">recompile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># import DTM</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dtm</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.load.html#numpy.load" title="numpy.load" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">load</span></a><span class="p">(</span><span class="s1">&#39;../../models/Graben_base_model_topography.npy&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Active grids: [&#39;regular&#39;]
Active grids: [&#39;regular&#39; &#39;topography&#39;]
</pre></div>
</div>
<p>Using the method <cite>.get_additional_data()</cite>, we can display a summary of model information and parameters, such as the kriging parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geo_model</span><span class="o">.</span><span class="n">get_additional_data</span><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="9" valign="top">Structure</th>
      <th>isLith</th>
      <td>True</td>
    </tr>
    <tr>
      <th>isFault</th>
      <td>True</td>
    </tr>
    <tr>
      <th>number faults</th>
      <td>5</td>
    </tr>
    <tr>
      <th>number surfaces</th>
      <td>11</td>
    </tr>
    <tr>
      <th>number series</th>
      <td>10</td>
    </tr>
    <tr>
      <th>number surfaces per series</th>
      <td>[1, 1, 1, 1, 1, 3, 1, 1, 1, 0]</td>
    </tr>
    <tr>
      <th>len surfaces surface_points</th>
      <td>[6, 8, 12, 8, 6, 8, 14, 14, 26, 24, 24]</td>
    </tr>
    <tr>
      <th>len series surface_points</th>
      <td>[6, 8, 12, 8, 6, 36, 26, 24, 24, 0]</td>
    </tr>
    <tr>
      <th>len series orientations</th>
      <td>[2, 2, 6, 4, 2, 12, 16, 12, 10, 0]</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">Options</th>
      <th>dtype</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>output</th>
      <td>geology</td>
    </tr>
    <tr>
      <th>theano_optimizer</th>
      <td>fast_compile</td>
    </tr>
    <tr>
      <th>device</th>
      <td>cpu</td>
    </tr>
    <tr>
      <th>verbosity</th>
      <td>None</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Kriging</th>
      <th>range</th>
      <td>32190.8</td>
    </tr>
    <tr>
      <th>$C_o$</th>
      <td>2.46726e+07</td>
    </tr>
    <tr>
      <th>drift equations</th>
      <td>[3, 3, 3, 3, 3, 3, 3, 3, 3, 3]</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Rescaling</th>
      <th>rescaling factor</th>
      <td>56916.7</td>
    </tr>
    <tr>
      <th>centers</th>
      <td>[14239.166495, 6900.0, -2581.92853]</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<br />
<br /><p>Changing the kriging parameters affects the resulting models, e.g. the range represents the maximum correlation distance, or reducing the coefficient of correlation will yield a smoother, less “bumpy” model. For the POC-model, we set the <cite>range</cite> to 20000 and the correlation coefficient $C_o$ to 200000. Then we set up the interpolator, i.e. compile the functions which will calculate the scalar fields of our model surfaces.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># adapt kriging to the parameters of previous example</span>
<span class="c1"># decrease the kriging range</span>
<span class="n">geo_model</span><span class="o">.</span><span class="n">modify_kriging_parameters</span><span class="p">(</span><span class="s1">&#39;range&#39;</span><span class="p">,</span> <span class="mf">20000.</span><span class="p">)</span>
<span class="n">geo_model</span><span class="o">.</span><span class="n">modify_kriging_parameters</span><span class="p">(</span><span class="s1">&#39;$C_o$&#39;</span><span class="p">,</span> <span class="mf">2e5</span><span class="p">)</span>


<span class="c1"># Set the interpolator function</span>
<span class="c1"># Create the theano model</span>
<span class="n">gp</span><span class="o">.</span><span class="n">set_interpolator</span><span class="p">(</span><span class="n">geo_model</span><span class="p">,</span>
                         <span class="n">compile_theano</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">theano_optimizer</span><span class="o">=</span><span class="s1">&#39;fast_compile&#39;</span><span class="p">,</span>
                         <span class="n">verbose</span><span class="o">=</span><span class="p">[],</span>
                         <span class="n">update_kriging</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>

<span class="c1"># compute the model</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span><span class="p">(</span><span class="n">geo_model</span><span class="p">,</span> <span class="n">compute_mesh</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Compiling theano function...
Level of Optimization:  fast_compile
Device:  cpu
Precision:  float64
Number of faults:  5
Compilation Done!
Kriging values:
                                          values
range                                     20000
$C_o$                                    200000
drift equations  [3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
</pre></div>
</div>
<p>Now that the model is computed, lets have a look at a cross-section along the y-axis, so across the graben system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span><span class="p">(</span><span class="n">geo_model</span><span class="p">,</span> <span class="n">cell_number</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">show_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_topography</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">show_lith</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_boundaries</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
<img alt="Cell Number: 25 Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_02_POC_create-MC-ensemble_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.visualization_2d.Plot2D object at 0x000001FA905D99D0&gt;
</pre></div>
</div>
<p>The two distinct domains in this model are directly visible: (i) the old graben system (extensional regime), covered by the (ii) thrusted, younger units.</p>
</div>
<div class="section" id="add-gravity-grid">
<h2>Add Gravity grid<a class="headerlink" href="#add-gravity-grid" title="Permalink to this headline">¶</a></h2>
<p>In the previous example, next to creating the model, we chose quasi-random locations for 15 gravity stations. The gravity signal of the base POC-model is simulated at these 15 stations. In the following workflows, we assume that these 15 stations were measured. So they serve as observed data for conditioning the MonteCarlo Ensemble of different geological geometries.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># In[7]:</span>


<span class="n">grav_stations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../../data/Data_for_MC/20210322_forw_grav_seed58.csv&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_coordinates</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.stack.html#numpy.stack" title="numpy.stack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">stack</span></a><span class="p">((</span><span class="n">grav_stations</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                                <span class="n">grav_stations</span><span class="o">.</span><span class="n">Y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                                <span class="n">grav_stations</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<a href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<a href="https://matplotlib.org/api/collections_api.html#matplotlib.collections.PathCollection" title="matplotlib.collections.PathCollection" class="sphx-glr-backref-module-matplotlib-collections sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cb</span></a> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.scatter.html#matplotlib.pyplot.scatter" title="matplotlib.pyplot.scatter" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span></a><span class="p">(</span><span class="n">grav_stations</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">grav_stations</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">grav_stations</span><span class="p">[</span><span class="s1">&#39;grav&#39;</span><span class="p">],</span>
           <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <a href="https://matplotlib.org/api/collections_api.html#matplotlib.collections.PathCollection" title="matplotlib.collections.PathCollection" class="sphx-glr-backref-module-matplotlib-collections sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><a href="https://matplotlib.org/api/collections_api.html#matplotlib.collections.PathCollection" title="matplotlib.collections.PathCollection" class="sphx-glr-backref-module-matplotlib-collections sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cb</span></a><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gravity&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel" title="matplotlib.pyplot.ylabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s1">&#39;y [m]&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="02 POC create MC ensemble" class="sphx-glr-single-img" src="../_images/sphx_glr_02_POC_create-MC-ensemble_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 13.944444444444438, &#39;x [m]&#39;)
</pre></div>
</div>
<p>These stations are used for creating a centered grid around each station. The centered grid has an extent of 10 cells in x- and y-direction, and 15 cells in the z-direction.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geo_model</span><span class="o">.</span><span class="n">set_centered_grid</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_coordinates</span></a><span class="p">,</span>  <span class="n">resolution</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">radius</span><span class="o">=</span><span class="mi">6000</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">GravityPreprocessing</span><span class="p">(</span><span class="n">geo_model</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">centered_grid</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tz</span></a> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">set_tz_kernel</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Active grids: [&#39;regular&#39; &#39;topography&#39; &#39;centered&#39;]
</pre></div>
</div>
<p>We see that there are three active grids. On each, the gravity signal will be calculated. Of course, we can let it be calculated on each grid, but we may not need the information on e.g. the topography grid (which would for instance yield the geological map).
So we can set only the centered grid to active, which speeds up the simulation.</p>
<p><strong>Note</strong> that you’ll need to model also the regular grid, if you plan to export the <cite>lith_block</cite> geological voxel model later on!
As we want to also have the geometric changes in the lithological grid, we set <cite>reset=False</cite>. If we were to set it to <cite>True</cite>, only the ‘centered’ grid would be active.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geo_model</span><span class="o">.</span><span class="n">set_active_grid</span><span class="p">(</span><span class="s1">&#39;centered&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Active grids: [&#39;regular&#39; &#39;topography&#39; &#39;centered&#39;]

Grid Object. Values:
array([[  140.        ,   140.        , -6437.5       ],
       [  140.        ,   140.        , -6312.5       ],
       [  140.        ,   140.        , -6187.5       ],
       ...,
       [30888.89      ,  6285.71      , -3495.98176905],
       [30888.89      ,  6285.71      , -4948.49684561],
       [30888.89      ,  6285.71      , -6966.76      ]])
</pre></div>
</div>
<p>The centered grid will now be the only one where the model information is stored, meaning less computational time. Let’s have a look how this comes in handy, when we start to modify the depth of units and calculate the gravity.</p>
<p>Before running the simulations, we need to assign densities to the rock units, otherwise it will raise an error.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># add densities - from abdelfettah 2014 and SAPHYR</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">densities</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">2.466</span><span class="p">,</span> <span class="mf">2.61</span><span class="p">,</span> <span class="mf">2.53</span><span class="p">,</span>
             <span class="mf">2.61</span><span class="p">,</span> <span class="mf">2.47</span><span class="p">,</span> <span class="mf">2.55</span><span class="p">,</span> <span class="mf">2.67</span><span class="p">]</span>
<span class="n">geo_model</span><span class="o">.</span><span class="n">add_surface_values</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">densities</span></a><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style  type="text/css" >
    #T_d359463c_e325_11eb_8ffd_00e04c6800carow0_col3 {
            background-color:  #5DA629;
        }    #T_d359463c_e325_11eb_8ffd_00e04c6800carow1_col3 {
            background-color:  #5DA629;
        }    #T_d359463c_e325_11eb_8ffd_00e04c6800carow2_col3 {
            background-color:  #015482;
        }    #T_d359463c_e325_11eb_8ffd_00e04c6800carow3_col3 {
            background-color:  #015482;
        }    #T_d359463c_e325_11eb_8ffd_00e04c6800carow4_col3 {
            background-color:  #015482;
        }    #T_d359463c_e325_11eb_8ffd_00e04c6800carow5_col3 {
            background-color:  #dbdbac;
        }    #T_d359463c_e325_11eb_8ffd_00e04c6800carow6_col3 {
            background-color:  #e588f3;
        }    #T_d359463c_e325_11eb_8ffd_00e04c6800carow7_col3 {
            background-color:  #ff792b;
        }    #T_d359463c_e325_11eb_8ffd_00e04c6800carow8_col3 {
            background-color:  #725c9a;
        }    #T_d359463c_e325_11eb_8ffd_00e04c6800carow9_col3 {
            background-color:  #cfc199;
        }    #T_d359463c_e325_11eb_8ffd_00e04c6800carow10_col3 {
            background-color:  #a5d490;
        }    #T_d359463c_e325_11eb_8ffd_00e04c6800carow11_col3 {
            background-color:  #c7848f;
        }</style><table id="T_d359463c_e325_11eb_8ffd_00e04c6800ca" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >surface</th>        <th class="col_heading level0 col1" >series</th>        <th class="col_heading level0 col2" >order_surfaces</th>        <th class="col_heading level0 col3" >color</th>        <th class="col_heading level0 col4" >id</th>        <th class="col_heading level0 col5" >density</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_d359463c_e325_11eb_8ffd_00e04c6800calevel0_row0" class="row_heading level0 row0" >9</th>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow0_col0" class="data row0 col0" >Thrust1_south</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow0_col1" class="data row0 col1" >Thrust1_series</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow0_col2" class="data row0 col2" >1</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow0_col3" class="data row0 col3" >#5DA629</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow0_col4" class="data row0 col4" >1</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow0_col5" class="data row0 col5" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_d359463c_e325_11eb_8ffd_00e04c6800calevel0_row1" class="row_heading level0 row1" >10</th>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow1_col0" class="data row1 col0" >Thrust2_south</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow1_col1" class="data row1 col1" >Thrust2_series</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow1_col2" class="data row1 col2" >1</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow1_col3" class="data row1 col3" >#5DA629</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow1_col4" class="data row1 col4" >2</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow1_col5" class="data row1 col5" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_d359463c_e325_11eb_8ffd_00e04c6800calevel0_row2" class="row_heading level0 row2" >0</th>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow2_col0" class="data row2 col0" >Fault2</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow2_col1" class="data row2 col1" >Fault2_series</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow2_col2" class="data row2 col2" >1</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow2_col3" class="data row2 col3" >#015482</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow2_col4" class="data row2 col4" >3</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow2_col5" class="data row2 col5" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_d359463c_e325_11eb_8ffd_00e04c6800calevel0_row3" class="row_heading level0 row3" >1</th>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow3_col0" class="data row3 col0" >Fault5</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow3_col1" class="data row3 col1" >Fault5_series</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow3_col2" class="data row3 col2" >1</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow3_col3" class="data row3 col3" >#015482</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow3_col4" class="data row3 col4" >4</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow3_col5" class="data row3 col5" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_d359463c_e325_11eb_8ffd_00e04c6800calevel0_row4" class="row_heading level0 row4" >2</th>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow4_col0" class="data row4 col0" >Fault6</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow4_col1" class="data row4 col1" >Fault6_series</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow4_col2" class="data row4 col2" >1</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow4_col3" class="data row4 col3" >#015482</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow4_col4" class="data row4 col4" >5</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow4_col5" class="data row4 col5" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_d359463c_e325_11eb_8ffd_00e04c6800calevel0_row5" class="row_heading level0 row5" >6</th>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow5_col0" class="data row5 col0" >Tertiary</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow5_col1" class="data row5 col1" >Post_tectonic_series</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow5_col2" class="data row5 col2" >1</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow5_col3" class="data row5 col3" >#dbdbac</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow5_col4" class="data row5 col4" >6</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow5_col5" class="data row5 col5" >2.466000</td>
            </tr>
            <tr>
                        <th id="T_d359463c_e325_11eb_8ffd_00e04c6800calevel0_row6" class="row_heading level0 row6" >8</th>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow6_col0" class="data row6 col0" >Pink</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow6_col1" class="data row6 col1" >Post_tectonic_series</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow6_col2" class="data row6 col2" >2</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow6_col3" class="data row6 col3" >#e588f3</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow6_col4" class="data row6 col4" >7</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow6_col5" class="data row6 col5" >2.610000</td>
            </tr>
            <tr>
                        <th id="T_d359463c_e325_11eb_8ffd_00e04c6800calevel0_row7" class="row_heading level0 row7" >7</th>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow7_col0" class="data row7 col0" >Orange</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow7_col1" class="data row7 col1" >Post_tectonic_series</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow7_col2" class="data row7 col2" >3</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow7_col3" class="data row7 col3" >#ff792b</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow7_col4" class="data row7 col4" >8</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow7_col5" class="data row7 col5" >2.530000</td>
            </tr>
            <tr>
                        <th id="T_d359463c_e325_11eb_8ffd_00e04c6800calevel0_row8" class="row_heading level0 row8" >5</th>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow8_col0" class="data row8 col0" >Unconformity</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow8_col1" class="data row8 col1" >Detachement</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow8_col2" class="data row8 col2" >1</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow8_col3" class="data row8 col3" >#725c9a</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow8_col4" class="data row8 col4" >9</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow8_col5" class="data row8 col5" >2.610000</td>
            </tr>
            <tr>
                        <th id="T_d359463c_e325_11eb_8ffd_00e04c6800calevel0_row9" class="row_heading level0 row9" >4</th>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow9_col0" class="data row9 col0" >Upper-filling</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow9_col1" class="data row9 col1" >Syn_tectonic_series2</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow9_col2" class="data row9 col2" >1</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow9_col3" class="data row9 col3" >#cfc199</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow9_col4" class="data row9 col4" >10</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow9_col5" class="data row9 col5" >2.470000</td>
            </tr>
            <tr>
                        <th id="T_d359463c_e325_11eb_8ffd_00e04c6800calevel0_row10" class="row_heading level0 row10" >3</th>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow10_col0" class="data row10 col0" >Lower-filling</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow10_col1" class="data row10 col1" >Pre_tectonic_series</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow10_col2" class="data row10 col2" >1</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow10_col3" class="data row10 col3" >#a5d490</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow10_col4" class="data row10 col4" >11</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow10_col5" class="data row10 col5" >2.550000</td>
            </tr>
            <tr>
                        <th id="T_d359463c_e325_11eb_8ffd_00e04c6800calevel0_row11" class="row_heading level0 row11" >11</th>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow11_col0" class="data row11 col0" >basement</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow11_col1" class="data row11 col1" >Basement</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow11_col2" class="data row11 col2" >1</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow11_col3" class="data row11 col3" >#c7848f</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow11_col4" class="data row11 col4" >12</td>
                        <td id="T_d359463c_e325_11eb_8ffd_00e04c6800carow11_col5" class="data row11 col5" >2.670000</td>
            </tr>
    </tbody></table>
</div>
<br />
<br /></div>
<div class="section" id="mc-variation">
<h2>MC Variation<a class="headerlink" href="#mc-variation" title="Permalink to this headline">¶</a></h2>
<p>For varying the depth of units, we extract the indices of the units whose input points we want to modify. To guarantee that we always vary the original depth in each realization (and not the depth used in the previous realization), we first generate an initial-depth array, containing the original depth information of all input points:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Z_init</span> <span class="o">=</span> <span class="n">geo_model</span><span class="o">.</span><span class="n">surface_points</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<p>Having all the undisturbed depth values, we extract all surface points belonging to the units whose inputs we want to vary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graben_lower</span> <span class="o">=</span> <span class="n">geo_model</span><span class="o">.</span><span class="n">surface_points</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;surface==&#39;Lower-filling&#39;&quot;</span><span class="p">)</span>
<span class="n">graben_middle</span> <span class="o">=</span> <span class="n">geo_model</span><span class="o">.</span><span class="n">surface_points</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;surface==&#39;Upper-filling&#39;&quot;</span><span class="p">)</span>
<span class="n">unconformity</span> <span class="o">=</span> <span class="n">geo_model</span><span class="o">.</span><span class="n">surface_points</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;surface==&#39;Unconformity&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Before running the Monte Carlo simulations, we set up the interpolator for a “fast-run”, i.e. it optimizes runtime on cost of compilation time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span><span class="o">.</span><span class="n">set_interpolator</span><span class="p">(</span><span class="n">geo_model</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gravity&#39;</span><span class="p">],</span>
                    <span class="n">theano_optimizer</span><span class="o">=</span><span class="s1">&#39;fast_run&#39;</span><span class="p">,</span>
                    <span class="n">update_kriging</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Setting kriging parameters to their default values.
Compiling theano function...
Level of Optimization:  fast_run
Device:  cpu
Precision:  float64
Number of faults:  5
Compilation Done!
Kriging values:
                                          values
range                                   32190.8
$C_o$                               2.46726e+07
drift equations  [3, 3, 3, 3, 3, 3, 3, 3, 3, 3]

&lt;gempy.core.interpolator.InterpolatorModel object at 0x000001FA8FEFA430&gt;
</pre></div>
</div>
<p>Now we are good to go and run the Monte Carlo simulation. In the following, we fix a numpy random number seed so that this MC-simulation is reproducible
Then, we create empty arrays and dictionaries for the lithologies and gravity, respectively. In a <cite>for</cite> loop, we then vary depths of interface points and
compute a model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="numpy.random.seed" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># allocate array for lithology blocks</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lith_blocks</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([])</span>
<span class="c1"># create a dictionary to store gravity of simulations</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grav</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="c1"># get indices where the variable input points are</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Lgraben</span></a> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">graben_lower</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ugraben</span></a> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">graben_middle</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Uncon</span></a> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">unconformity</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Cindices</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Lgraben</span></a> <span class="o">+</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ugraben</span></a> <span class="o">+</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Uncon</span></a>

<span class="c1"># set number of realizations</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_iterations</span></a> <span class="o">=</span> <span class="mi">10</span>

<span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_iterations</span></a><span class="p">):</span>
    <span class="c1"># vary surface points</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Z_var</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.normal.html#numpy.random.normal" title="numpy.random.normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Z_loc</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.hstack.html#numpy.hstack" title="numpy.hstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">hstack</span></a><span class="p">([</span><span class="n">Z_init</span><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Lgraben</span></a><span class="p">]</span> <span class="o">+</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Z_var</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                       <span class="n">Z_init</span><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ugraben</span></a><span class="p">]</span> <span class="o">+</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Z_var</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                       <span class="n">Z_init</span><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Uncon</span></a><span class="p">]</span> <span class="o">+</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Z_var</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="c1"># apply variation to model</span>
    <span class="n">geo_model</span><span class="o">.</span><span class="n">modify_surface_points</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Cindices</span></a><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Z_loc</span></a><span class="p">)</span>
    <span class="c1"># re-compute model</span>
    <span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span><span class="p">(</span><span class="n">geo_model</span><span class="p">)</span>
    <span class="c1"># store lithologies ONLY THERE IF REGULAR GRID IS ACTIVE</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lith_blocks</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.append.html#numpy.append" title="numpy.append" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">append</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lith_blocks</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">lith_block</span></a><span class="p">)</span>
    <span class="c1"># store gravity</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grav</span></a><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Real_</span><span class="si">{</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geo_model</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">fw_gravity</span></a>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lith_blocks</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lith_blocks</span></a><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_iterations</span></a><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="export-models-and-gravity">
<h2>Export models and gravity<a class="headerlink" href="#export-models-and-gravity" title="Permalink to this headline">¶</a></h2>
<p>For post-processing of use in different software (e.g. numerical simulators for heat- and mass-transport), knowing ways of exporting the MC-results, in this case the simulated gravity and the lithology-blocks, comes in handy. There are many different ways of saving stuff (e.g. pickle the simulation results), but here we present simple exports as <cite>.csv</cite> and <cite>.npy</cite> files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gravdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grav</span></a><span class="p">)</span>

<span class="c1"># add station coordinates to the dataframe</span>
<span class="n">gravdf</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_coordinates</span></a><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">gravdf</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_coordinates</span></a><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">gravdf</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span> <span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_coordinates</span></a><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">gravdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Real_0</th>
      <th>Real_1</th>
      <th>Real_2</th>
      <th>Real_3</th>
      <th>Real_4</th>
      <th>Real_5</th>
      <th>Real_6</th>
      <th>Real_7</th>
      <th>Real_8</th>
      <th>Real_9</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-533.673251</td>
      <td>-532.673751</td>
      <td>-534.038468</td>
      <td>-533.143688</td>
      <td>-534.590898</td>
      <td>-533.483330</td>
      <td>-533.631910</td>
      <td>-534.186293</td>
      <td>-533.873075</td>
      <td>-534.097548</td>
      <td>21777.78</td>
      <td>7142.86</td>
      <td>405.17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-533.469712</td>
      <td>-531.718800</td>
      <td>-534.009147</td>
      <td>-532.039845</td>
      <td>-534.347122</td>
      <td>-533.275549</td>
      <td>-533.126723</td>
      <td>-534.074861</td>
      <td>-533.600943</td>
      <td>-534.057343</td>
      <td>22343.43</td>
      <td>9142.86</td>
      <td>455.98</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-529.378333</td>
      <td>-529.036879</td>
      <td>-528.462048</td>
      <td>-529.954048</td>
      <td>-525.608291</td>
      <td>-527.275759</td>
      <td>-528.747860</td>
      <td>-527.931698</td>
      <td>-527.359286</td>
      <td>-526.207417</td>
      <td>16686.87</td>
      <td>4285.71</td>
      <td>389.34</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-533.691969</td>
      <td>-531.952383</td>
      <td>-534.055335</td>
      <td>-532.632034</td>
      <td>-533.845509</td>
      <td>-532.641484</td>
      <td>-533.093253</td>
      <td>-534.387168</td>
      <td>-533.574950</td>
      <td>-533.370863</td>
      <td>21494.95</td>
      <td>8000.00</td>
      <td>424.80</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-533.735260</td>
      <td>-532.092981</td>
      <td>-534.197462</td>
      <td>-532.649674</td>
      <td>-533.692935</td>
      <td>-532.890857</td>
      <td>-533.219227</td>
      <td>-534.262520</td>
      <td>-533.789781</td>
      <td>-533.422763</td>
      <td>21494.95</td>
      <td>11428.57</td>
      <td>469.85</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<br />
<br /><p>This can be saved as usual with <cite>df.to_csv(‘pathname’)</cite> using Pandas. For the lithological block model, one good option is to save it as a numpy array, using <cite>numpy.save()</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.save.html#numpy.save" title="numpy.save" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">save</span></a><span class="p">(</span><span class="s1">&#39;../../data/outputs/MCexample_10realizations.npy&#39;</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lith_blocks</span></a><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="quick-model-analysis">
<h2>Quick model analysis<a class="headerlink" href="#quick-model-analysis" title="Permalink to this headline">¶</a></h2>
<p>Let’s have a quick first look at the resulting gravity and lithological block models. From the gravity dictionary, we can quickly generate a dataframe, convenient for further model analysis.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">prob_block</span></a> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">bayesian</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">probability</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lith_blocks</span></a><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ie_block</span></a> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">bayesian</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">information_entropy</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">prob_block</span></a><span class="p">)</span>
</pre></div>
</div>
<p>The following plot shows the probability of unit 5 in the probability block. With faults not being excluded, and counting of units starting with 0, we can see that the index 5 relates to the <cite>Lower-filling</cite> surface. The plot shows where to expect the unit. Everywhere, this unit is present throughout the simulations, the probability plot shows a bright yellow (probability = 1). Where it is always absent, we see the dark violet (probability = 0). The blueish-greenish areas are in between, meaning that in some realizations, the <cite>Lower-filling</cite> unit is present there, in other realization it is not.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">layer</span></a> <span class="o">=</span> <span class="mi">5</span>
<span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span><span class="p">(</span><span class="n">geo_model</span><span class="p">,</span>
            <span class="n">show_lith</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_boundaries</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">regular_grid</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">prob_block</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">layer</span></a><span class="p">],</span>
            <span class="n">kwargs_regular_grid</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span> <span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;norm&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
            <span class="p">);</span>
</pre></div>
</div>
<img alt="Cell Number: mid Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_02_POC_create-MC-ensemble_003.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.visualization_2d.Plot2D object at 0x000001FA903C0EB0&gt;
</pre></div>
</div>
<p>In the for-loop above, we not only varied the bottom boundary of the <cite>Lower-filling</cite> unit, but also <cite>Upper-filling</cite> and <cite>Unconformity</cite>. Using the measure of information entropy, we can visualize the parts of the model, where the most change is happening, i.e. where entropy is largest. Black areas in the following plot have zero information entropy, as there is only one “microstate” for the system, i.e. the model ensemble.</p>
<p>This means, we’d always encounter the same unit at the same place in every ensemble member. The colored areas, however, are areas where we’d encounter different geological units between ensemble members.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span><span class="o">.</span><span class="n">plot_2d</span><span class="p">(</span><span class="n">geo_model</span><span class="p">,</span>
            <span class="n">show_lith</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_boundaries</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">regular_grid</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ie_block</span></a><span class="p">,</span>
            <span class="n">kwargs_regular_grid</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span> <span class="s1">&#39;magma&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;norm&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
            <span class="p">);</span>
</pre></div>
</div>
<img alt="Cell Number: mid Direction: y" class="sphx-glr-single-img" src="../_images/sphx_glr_02_POC_create-MC-ensemble_004.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy.plot.visualization_2d.Plot2D object at 0x000001FACF779C40&gt;
</pre></div>
</div>
<p>Finally, let’s have a look at the gravity. We’ll simply have a look at mean and standard deviation of the simulated gravity of the ensemble:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># make subplots with mean and std</span>
<span class="n">gravdf_plt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grav</span></a><span class="p">)</span>
<a href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">m_grav</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">gravdf_plt</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">st_grav</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.std.html#numpy.std" title="numpy.std" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">std</span></a><span class="p">(</span><span class="n">gravdf_plt</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<a href="https://matplotlib.org/api/collections_api.html#matplotlib.collections.PathCollection" title="matplotlib.collections.PathCollection" class="sphx-glr-backref-module-matplotlib-collections sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">m</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">grav_stations</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">grav_stations</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">m_grav</span><span class="p">,</span>
           <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <a href="https://matplotlib.org/api/collections_api.html#matplotlib.collections.PathCollection" title="matplotlib.collections.PathCollection" class="sphx-glr-backref-module-matplotlib-collections sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dtm</span></a><span class="p">[:,:,</span><span class="mi">0</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dtm</span></a><span class="p">[:,:,</span><span class="mi">1</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dtm</span></a><span class="p">[:,:,</span><span class="mi">2</span><span class="p">],</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_earth&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dtm</span></a><span class="p">[:,:,</span><span class="mi">0</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dtm</span></a><span class="p">[:,:,</span><span class="mi">1</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dtm</span></a><span class="p">[:,:,</span><span class="mi">2</span><span class="p">],</span><span class="mi">10</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://matplotlib.org/api/collections_api.html#matplotlib.collections.PathCollection" title="matplotlib.collections.PathCollection" class="sphx-glr-backref-module-matplotlib-collections sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">grav_stations</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">grav_stations</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">st_grav</span><span class="p">,</span>
              <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <a href="https://matplotlib.org/api/collections_api.html#matplotlib.collections.PathCollection" title="matplotlib.collections.PathCollection" class="sphx-glr-backref-module-matplotlib-collections sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dtm</span></a><span class="p">[:,:,</span><span class="mi">0</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dtm</span></a><span class="p">[:,:,</span><span class="mi">1</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dtm</span></a><span class="p">[:,:,</span><span class="mi">2</span><span class="p">],</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_earth&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dtm</span></a><span class="p">[:,:,</span><span class="mi">0</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dtm</span></a><span class="p">[:,:,</span><span class="mi">1</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dtm</span></a><span class="p">[:,:,</span><span class="mi">2</span><span class="p">],</span><span class="mi">10</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure.colorbar" title="matplotlib.figure.Figure.colorbar" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><a href="https://matplotlib.org/api/collections_api.html#matplotlib.collections.PathCollection" title="matplotlib.collections.PathCollection" class="sphx-glr-backref-module-matplotlib-collections sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">m</span></a><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gravity&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure.colorbar" title="matplotlib.figure.Figure.colorbar" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><a href="https://matplotlib.org/api/collections_api.html#matplotlib.collections.PathCollection" title="matplotlib.collections.PathCollection" class="sphx-glr-backref-module-matplotlib-collections sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;std of gravity&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ensemble mean&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ensemble standard deviation&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y [m]&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X [m]&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X [m]&#39;</span><span class="p">)</span>

<a href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure.tight_layout" title="matplotlib.figure.Figure.tight_layout" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span></a><span class="p">()</span>
</pre></div>
</div>
<img alt="Ensemble mean, Ensemble standard deviation" class="sphx-glr-single-img" src="../_images/sphx_glr_02_POC_create-MC-ensemble_005.png" />
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 4 minutes  40.618 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-wp2-geo-modeling-02-poc-create-mc-ensemble-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/efb5128c0870b1c232fadb2e499d95db/02_POC_create-MC-ensemble.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">02_POC_create-MC-ensemble.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/b5fb379eac7833418c8b3903ad887013/02_POC_create-MC-ensemble.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">02_POC_create-MC-ensemble.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/ps_aargau_logo_200px.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">Pilot Study Geothermie Aargau</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=Japhiolite&repo=PSGeothermieAargau&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the_project.html">The project</a></li>
</ul>
<p class="caption"><span class="caption-text">Galleries:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../WP1data_analysis/index.html">Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WP2geo_modeling/index.html">Geological Model</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019 - 2021, Jan Niederau.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/WP2-geo_modeling/02_POC_create-MC-ensemble.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>